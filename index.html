<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Reid and Richard Brock">

<title>OECD curiosity analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="OECDCuriosity2_files/libs/clipboard/clipboard.min.js"></script>
<script src="OECDCuriosity2_files/libs/quarto-html/quarto.js"></script>
<script src="OECDCuriosity2_files/libs/quarto-html/popper.min.js"></script>
<script src="OECDCuriosity2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="OECDCuriosity2_files/libs/quarto-html/anchor.min.js"></script>
<link href="OECDCuriosity2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="OECDCuriosity2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="OECDCuriosity2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="OECDCuriosity2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="OECDCuriosity2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">OECD curiosity analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chris Reid and Richard Brock </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="oecd-curiosity-analysis" class="level2">
<h2 class="anchored" data-anchor-id="oecd-curiosity-analysis">OECD curiosity analysis</h2>
<p>I have added the appendix with some item descriptions in the OneDrive folder <a href="https://emckclac-my.sharepoint.com/:x:/g/personal/k1765032_kcl_ac_uk/EbSMrXCv_-dEqTqZM5sZoUQBW_deyV-40VYQ5oGRsdWlLw?e=2pRgv6">here</a> (as I keep forgetting what the item codes refer to!). I have also added the student, parent and school surveys to this <a href="https://emckclac-my.sharepoint.com/:f:/g/personal/k1765032_kcl_ac_uk/Ekw-k-oSk7lBv2XVJR6KpJ4BHKTxxWWgGYsZ9Di1lVysqQ?e=JBRhET">folder</a>, and the code books <a href="https://emckclac-my.sharepoint.com/:f:/g/personal/k1765032_kcl_ac_uk/EuupjG39CvtJs_cuOLEpEQUBlfu6orLUfVOVMaXweWvNPA?e=wq7Xrk">here</a>.</p>
<p>We can include code snippets using the code blocks:</p>
<p>We need to load the packages and data but don’t need to run this each time</p>
<p>!! i<strong><em>n fact, this code won’t run for you, as it tries to load the SSES file from a location on my laptop. So I would select the install packages lines and library lines, and run them - you will have the SSES dataframe loaded anyway so the other code blocks should run for you</em></strong> !!</p>
</section>
<section id="weighting" class="level2">
<h2 class="anchored" data-anchor-id="weighting">Weighting</h2>
<p>As we are getting into the analysis it is time to add the weightings. There is an overall weighted curiosity item (<code>CUR_WLE_ADJ</code>) but I assume that combines all five curiosity items. We might want to have a weighted version of just one item, e.g <code>STA_CUR01</code>. We can use the packages <code>survey</code> and <code>srvyr</code>, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See this helpful video: https://www.youtube.com/watch?v=brxx81U6N1o</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># There doesn't seem to be any difference with the weighted version, but I think I might be doing this wrong!</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>SSESwght<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_survey_rep</span>(<span class="at">variables=</span><span class="fu">c</span>(STA_CUR01), <span class="at">type =</span> <span class="st">"JK1"</span>, <span class="at">weights=</span>WT2019,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">repweights =</span> rwgt1<span class="sc">:</span>rwgt76, <span class="at">scale=</span>(<span class="dv">75</span><span class="sc">/</span><span class="dv">76</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">combined_weights =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>SSESwght<span class="ot">&lt;-</span>SSESwght<span class="sc">$</span>variables</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>SSESwght<span class="ot">&lt;-</span>SSESwght<span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">STA_CUR01Wght=</span>STA_CUR01)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>SumNoW<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID)<span class="sc">%&gt;%</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meancur=</span><span class="fu">mean</span>(STA_CUR01,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>SSESwght<span class="ot">&lt;-</span><span class="fu">cbind</span>(SSES, SSESwght)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>SumW<span class="ot">&lt;-</span>SSESwght<span class="sc">%&gt;%</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID)<span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meancur=</span><span class="fu">mean</span>(STA_CUR01Wght,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>SumNoW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   SiteID           meancur
   &lt;chr+lbl&gt;          &lt;dbl&gt;
 1 ""                NaN   
 2 "01" [Ottawa]       4.16
 3 "02" [Houston]      4.11
 4 "03" [Bogota]       4.18
 5 "04" [Manizales]    4.18
 6 "06" [Helsinki]     3.94
 7 "07" [Moscow]       3.99
 8 "08" [Istanbul]     4.18
 9 "09" [Daegu]        4.16
10 "10" [Sintra]       4.21
11 "11" [Suzhou]       4.14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>SumW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   SiteID           meancur
   &lt;chr+lbl&gt;          &lt;dbl&gt;
 1 ""                NaN   
 2 "01" [Ottawa]       4.16
 3 "02" [Houston]      4.11
 4 "03" [Bogota]       4.18
 5 "04" [Manizales]    4.18
 6 "06" [Helsinki]     3.94
 7 "07" [Moscow]       3.99
 8 "08" [Istanbul]     4.18
 9 "09" [Daegu]        4.16
10 "10" [Sintra]       4.21
11 "11" [Suzhou]       4.14</code></pre>
</div>
</div>
</section>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review">Literature review</h2>
<p>Curiosity, in the epistemic sense has been defined as individual’s search for intellectual stimulation <span class="citation" data-cites="vonstumm2011">(<a href="#ref-vonstumm2011" role="doc-biblioref"><strong>vonstumm2011?</strong></a>)</span>;</p>
<p>Loewenstein <span class="citation" data-cites="loewenstein1994psychology">(<a href="#ref-loewenstein1994psychology" role="doc-biblioref"><strong>loewenstein1994psychology?</strong></a>)</span> argued that an individual becomes curious when they are made aware of an ‘information gap’ in their understanding .</p>
<p>The OECD (<span class="citation" data-cites="oecd2021">(<a href="#ref-oecd2021" role="doc-biblioref"><strong>oecd2021?</strong></a>)</span>) concluded that the Survey on Social and Emotional Skills (SSES) showed students’ curiosity falling between ages 10 and 15 and explained this in terms of ‘developmental factors’ and expectations within education systems for students to be compliant (p.3). The report also claimed that ‘triangulation’, which involved comparing students’ self-reported curiosity to parents’ and teachers’ ratings of students’ curiosity, confirmed this trend (p.116).</p>
<p>There are reasons to be cautious about this form of triangulation. Studies have shown that teachers’ ratings of students’ curiosity corresponded more closely with IQ than students’ self-reports (Maw and Maw, 1961) or observational reports of their curiosity (<span class="citation" data-cites="coie1974">(<a href="#ref-coie1974" role="doc-biblioref"><strong>coie1974?</strong></a>)</span>). Vidler and Levine (<span class="citation" data-cites="vidler1976">(<a href="#ref-vidler1976" role="doc-biblioref"><strong>vidler1976?</strong></a>)</span>) argued that correspondence between teacher and students’ own ratings their curiosity could be improved with alternative measures of curiosity but offer no evidence they took measures of students’ intelligence into account as a mediating factor.</p>
<p>Numerous authors have assumed that children’s curiosity falls during their time at school (e.g., <span class="citation" data-cites="clark2019">(<a href="#ref-clark2019" role="doc-biblioref"><strong>clark2019?</strong></a>)</span>; <span class="citation" data-cites="gordon2015">(<a href="#ref-gordon2015" role="doc-biblioref"><strong>gordon2015?</strong></a>)</span>; <span class="citation" data-cites="jirout">(<a href="#ref-jirout" role="doc-biblioref"><strong>jirout?</strong></a>)</span>; <span class="citation" data-cites="jirout2022">(<a href="#ref-jirout2022" role="doc-biblioref"><strong>jirout2022?</strong></a>)</span>; Tor and Gordon, 2020; <span class="citation" data-cites="zimmerman2022">(<a href="#ref-zimmerman2022" role="doc-biblioref"><strong>zimmerman2022?</strong></a>)</span>), often citing Engel’s (<span class="citation" data-cites="engel2015">(<a href="#ref-engel2015" role="doc-biblioref"><strong>engel2015?</strong></a>)</span>) claim that students’ rate of questioning declines as they get older. There are two issues with this claim. The first is the lack of evidence supporting it. The oft-cited study by Tizard and Hughes (1984), for example, only looked at the relative frequency with which preschool children asked questions at home and at nursery, and so their conclusions cannot be extrapolated to older children. Second, the frequency with which children ask questions is a relatively poor proxy for curiosity. Students ask questions for a variety of reasons, and only some of these can reasonably be described as motivated by curiosity.</p>
<p>Authors of the OECD’s justification for the SSES’s assessment framework (<span class="citation" data-cites="assessme2019">(<a href="#ref-assessme2019" role="doc-biblioref"><strong>assessme2019?</strong></a>)</span>) claimed that two previous studies showed a decline in children’s curiosity. Whilst Soto et al.&nbsp;(<span class="citation" data-cites="soto2011">(<a href="#ref-soto2011" role="doc-biblioref"><strong>soto2011?</strong></a>)</span>) did use a sample of over a million participants, recruited via the internet, and ranging in age from 10 to 65, the study did not assess curiosity <em>per se</em>, finding instead a decline in openness to experience during adolescent, a trend which reversed during adulthood. De Haan et al.&nbsp;(<span class="citation" data-cites="dehaan2017">(<a href="#ref-dehaan2017" role="doc-biblioref"><strong>dehaan2017?</strong></a>)</span>) found a steep decline in Belgian children’s curiosity between the ages of 6 and 17. The study used a longitudinal design, meaning that curiosity was assessed over time in the same children, but used mothers’ assessment of children’s curiosity alone, without any further validation of this form of measurement. The study sample also decreased from 579 children in the youngest age group to 424 in the eldest, meaning that the final assessment point is likely to be less reliable than the initial point.</p>
<p>In summary, the reliability of previous claims that curiosity declines as children progress through their schooling is variable. Further, all studies cited above were conducted on what Heinrich et al.&nbsp;(<span class="citation" data-cites="henrich2010">(<a href="#ref-henrich2010" role="doc-biblioref"><strong>henrich2010?</strong></a>)</span>) have called ‘WEIRD’– Western, Educated, Industrialized, Rich, and Democratic – populations. Heinrich et al.&nbsp;argue that it cannot be assumed that these populations are psychologically representative of the global population, and so findings cannot be straightforwardly generalised.</p>
<p>Because of these factors, the OECD SSES study would make a valuable contribution to the literature within this area. Conducted across 10 cities globally, some of which fall outside Heinrich et al.’s ‘WEIRD’ designation, it can arguably make a greater claim to generalisability than the studies cited above. The addition of triangulation potentially adds a further dimension to the study’s reliability. The finding that school students’ curiosity does decline between the ages of 10 and 15 across the 10 cities, if accurate, would therefore be a significant one.</p>
</section>
<section id="the-oecd-data-set" class="level2">
<h2 class="anchored" data-anchor-id="the-oecd-data-set">The OECD data set</h2>
<p>Since 2010, the OECD has been interested in carrying out research into young people’s social and emotional skills leading to the development of the Survey on Social and Emotional Skills (SSES) <span class="citation" data-cites="oecd2021">(<a href="#ref-oecd2021" role="doc-biblioref"><strong>oecd2021?</strong></a>)</span>. They survey was designed to report skills across five domains (open-mindedness, task performance, engaging with others, collaboration and emotional regulation) which mirrored the big five personality traits <span class="citation" data-cites="goldberg1993">(<a href="#ref-goldberg1993" role="doc-biblioref"><strong>goldberg1993?</strong></a>)</span>. Within the domain of open-mindedness three skills were examined, curiosity, tolerance and creativity.</p>
<p>The survey was delivered online and completed by two cohorts of students aged 10 and 15-years old.</p>
<p>Students in cities shown in table x took part in the data collection</p>
<p>Table x: Participating cities</p>
<table class="table">
<thead>
<tr class="header">
<th>Participating Cities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bogotá, Colombia</td>
</tr>
<tr class="even">
<td>Daegu, South Korea</td>
</tr>
<tr class="odd">
<td>Helsinki, Finland</td>
</tr>
<tr class="even">
<td>Houston, Texas, United States</td>
</tr>
<tr class="odd">
<td>Istanbul, Turkey</td>
</tr>
<tr class="even">
<td>Manizales, Colombia</td>
</tr>
<tr class="odd">
<td>Moscow, Russian Federation</td>
</tr>
<tr class="even">
<td>Ottawa, Ontario, Canada</td>
</tr>
<tr class="odd">
<td>Sintra, Portugal</td>
</tr>
<tr class="even">
<td>Suzhou, People’s Republic of China</td>
</tr>
</tbody>
</table>
<p>The gender distribution of participating students is shown in table y.</p>
<p>Table y gender of participating students</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>demographics<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID, Gender_Std, CohortID)<span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_factor</span>()<span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Gender_Std, <span class="at">values_from =</span> n)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(demographics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 5
# Groups:   SiteID [11]
   SiteID      CohortID          `NA` Female  Male
   &lt;fct&gt;       &lt;fct&gt;            &lt;int&gt;  &lt;int&gt; &lt;int&gt;
 1 ""          ""                  25     NA    NA
 2 "Ottawa"    "Younger cohort"   115   1576  1559
 3 "Ottawa"    "Older cohort"      36   1068  1086
 4 "Houston"   "Younger cohort"    34   1673  1626
 5 "Houston"   "Older cohort"      33   1613  1455
 6 "Bogota"    "Younger cohort"    21   1723  1671
 7 "Bogota"    "Older cohort"      27   1658  1671
 8 "Manizales" "Younger cohort"    26   1629  1571
 9 "Manizales" "Older cohort"      22   1824  1685
10 "Helsinki"  "Younger cohort"    30   1506  1498
# ℹ 11 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>youngtotal<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CohortID<span class="sc">==</span><span class="st">"1"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>oldtotal<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CohortID<span class="sc">==</span><span class="st">"2"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>total<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>youngtotal<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Younger cohort total"</span>, youngtotal)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>oldtotal<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Older cohort total"</span>, oldtotal)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>total<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">"Total"</span>, total)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>totalcohorts<span class="ot">&lt;-</span><span class="fu">rbind</span>(youngtotal, oldtotal, total)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(totalcohorts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  n    
youngtotal "Younger cohort total" 31187
oldtotal   "Older cohort total"   29798
total      "Total"                61010</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the variable we are interested in to numeric and character</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>SSES<span class="sc">$</span>st_anxtest<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(SSES<span class="sc">$</span>st_anxtest)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>SSES<span class="sc">$</span>STA_CUR01<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(SSES<span class="sc">$</span>STA_CUR01)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>SSES<span class="sc">$</span>Gender_Std<span class="ot">&lt;-</span><span class="fu">as.character</span>(SSES<span class="sc">$</span>Gender_Std)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean curiosity score by country</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Note I haven't used the weighted curiosity scores, I would need to do that properly in a more thorough analysis</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>CountCur<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteID, STA_CUR01)<span class="sc">%&gt;%</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID)<span class="sc">%&gt;%</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanCur=</span><span class="fu">mean</span>(STA_CUR01, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>CountCur<span class="sc">$</span>SiteID<span class="ot">&lt;-</span><span class="fu">as_factor</span>(CountCur<span class="sc">$</span>SiteID)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CountCur, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(SiteID, <span class="sc">-</span>MeanCur), <span class="at">y=</span>MeanCur, <span class="at">fill=</span>SiteID))<span class="sc">+</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"City"</span>)<span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean curiosity score"</span>)<span class="sc">+</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`position_stack()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(SSES<span class="sc">$</span>STA_CUR01)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(SSES<span class="sc">$</span>STA_CUR01, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(SSES<span class="sc">$</span>STA_CUR06)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>SSES,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01)) <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill=</span><span class="st">"darkseagreen4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 252 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>SSEStest<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SSES<span class="sc">$</span>STA_CUR01, SSES<span class="sc">$</span>STA_CUR02, SSES<span class="sc">$</span>STA_PER07, SSES<span class="sc">$</span>STA_PER08,SSES<span class="sc">$</span>st_anxtest, <span class="fu">as.numeric</span>(SSES<span class="sc">$</span>Gender_Std))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>cor<span class="ot">&lt;-</span><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(df), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor, <span class="at">order =</span> <span class="st">'AOE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cor<span class="ot">&lt;-</span><span class="fu">cor.test</span>(SSES<span class="sc">$</span>STA_CUR01, SSES<span class="sc">$</span>st_anxtest)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>cor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSES$STA_CUR01 and SSES$st_anxtest
t = 8.1218, df = 57529, p-value = 4.685e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.02567784 0.04200201
sample estimates:
       cor 
0.03384218 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a contingency table for the Wilcox Rank Test</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>conttab<span class="ot">&lt;-</span><span class="fu">xtabs</span>(<span class="sc">~</span> Gender_Std <span class="sc">+</span> STA_CUR01, <span class="at">data=</span>SSES)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the table to a data-frame as that is what wilcox.test wants! (and make the varibales numeric)</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>conttab<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(conttab)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>conttab<span class="sc">$</span>Gender_Std<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(conttab<span class="sc">$</span>Gender_Std)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>conttab<span class="sc">$</span>STA_CUR01<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(conttab<span class="sc">$</span>STA_CUR01)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For fun plot the graphs - there looks to be very little difference by gender</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>conttab, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>Freq, <span class="at">fill=</span>Gender_Std))<span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Gender_Std)<span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"null"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_col(stat = "identity"): Ignoring unknown parameters: `stat`</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the wilcox test - which returns p=1 so no difference!</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(STA_CUR01 <span class="sc">~</span> Gender_Std, <span class="at">data=</span>conttab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  STA_CUR01 by Gender_Std
W = 12.5, p-value = 1
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SSES<span class="sc">$</span>STA_CUR01, SSES<span class="sc">$</span>STA_CUR02, SSES<span class="sc">$</span>STA_PER07, SSES<span class="sc">$</span>STA_PER08)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(df), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               SSES.STA_CUR01 SSES.STA_CUR02 SSES.STA_PER07 SSES.STA_PER08
SSES.STA_CUR01      1.0000000      0.2754213      0.1537268      0.1872675
SSES.STA_CUR02      0.2754213      1.0000000      0.2642251      0.3636892
SSES.STA_PER07      0.1537268      0.2642251      1.0000000      0.4006114
SSES.STA_PER08      0.1872675      0.3636892      0.4006114      1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#un-reversing the reversed item</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>rc <span class="ot">&lt;-</span> (<span class="dv">6</span> <span class="sc">-</span> SSES<span class="sc">$</span>STA_CUR06)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SSES<span class="sc">$</span>STA_CUR01, SSES<span class="sc">$</span>STA_CUR02, SSES<span class="sc">$</span>STA_CUR03, SSES<span class="sc">$</span>STA_CUR04, SSES<span class="sc">$</span>STA_CUR05, rc, SSES<span class="sc">$</span>STA_CUR07, SSES<span class="sc">$</span>STA_CUR08)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate Cronbach's Alpha</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cronbach.alpha</span>(df, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cronbach's alpha for the 'df' data-set

Items: 8
Sample units: 61010
alpha: 0.795</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I think I've created my first 'meaningful' graphic!</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>CanCurLang<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteID, LANG, STA_CUR01)<span class="sc">%&gt;%</span> <span class="co"># Select cur01, city and lang variables</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SiteID<span class="sc">==</span><span class="st">"01"</span>)<span class="sc">%&gt;%</span> <span class="co"># Filter for Ottawa</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="co"># To prevent the levels for other countries confusing the table (not sure what this means or if necessary)</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> CanCurLang) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(STA_CUR01, LANG), <span class="at">fill=</span>LANG))<span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Language"</span>)<span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"How curious..."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `unite_()` was deprecated in tidyr 1.2.0.
ℹ Please use `unite()` instead.
ℹ The deprecated feature was likely used in the ggmosaic package.
  Please report the issue at &lt;https://github.com/haleyjeppson/ggmosaic&gt;.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>USCurLang<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteID, LANG, STA_CUR01)<span class="sc">%&gt;%</span> <span class="co"># City, Lang, Curiosity</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SiteID<span class="sc">==</span><span class="st">"02"</span>)<span class="sc">%&gt;%</span> <span class="co"># Filter Houston</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="co"># To prevent the levels for other countries confusing the table</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> USCurLang) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(STA_CUR01, LANG), <span class="at">fill=</span>LANG))<span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Language"</span>)<span class="sc">+</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"How curious..."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I added parts of the teacher and parent databases to the student one. OECD presented this as 'triangulation' (not all CUR items available from teacher questionnaire). Previous attempts to do this showed that teacher curiosity assessments were influenced by student attainment. Results below seem to show this too (teacher CUR05 correlated with reading scores, student and parent CUR05 correlate with one another).</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the sav file (the SPSS file)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SSES&lt;-read_sav("/Users/cr/Downloads/INT_01_ST_(2021.04.14)_Public.sav")</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>SSES<span class="ot">&lt;-</span><span class="fu">read_sav</span>(<span class="st">"/Users/k1765032/Downloads/INT_01_ST_(2021.04.14)_Public.sav"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of troublesome SPSS format</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>SSES<span class="ot">&lt;-</span><span class="fu">zap_label</span>(SSES)</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the variable we are interested in to numeric and character</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Parent database</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co"># SSESP&lt;-read_sav("/Users/cr/Downloads/INT_02_PA_(2021.04.14)_Public.sav")</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>SSESP<span class="ot">&lt;-</span><span class="fu">read_sav</span>(<span class="st">"/Users/k1765032/Downloads/INT_02_PA_(2021.04.14)_Public.sav"</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of troublesome SPSS format</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>SSESP<span class="ot">&lt;-</span><span class="fu">zap_label</span>(SSESP)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the variable we are interested in to numeric and character</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Teacher database</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co"># SSEST&lt;-read_sav("/Users/cr/Downloads/INT_03_TC_(2021.04.14)_Public.sav")</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>SSEST<span class="ot">&lt;-</span><span class="fu">read_sav</span>(<span class="st">"/Users/k1765032/Downloads/INT_03_TC_(2021.04.14)_Public.sav"</span>)</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of troublesome SPSS format</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>SSEST<span class="ot">&lt;-</span><span class="fu">zap_label</span>(SSEST)</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating database with some parental data</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>SSESParents <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  SSES <span class="sc">%&gt;%</span> <span class="fu">select</span>(Username_Std, Sgrade_Read_Lang, CohortID, STA_CUR01, STA_CUR02, STA_CUR03, STA_CUR04, STA_CUR05, STA_CUR06, STA_CUR07, STA_TOL01, STA_TOL02),</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  SSESP <span class="sc">%&gt;%</span> <span class="fu">select</span>(Username_Std, PAA_CUR01, PAA_CUR02, PAA_CUR03, PAA_CUR04, PAA_CUR05, PAA_CUR06, PAA_CUR07, PAA_CUR08),</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Username_Std"</span>))</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation test to check it works</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSESParents<span class="sc">$</span>STA_CUR01, SSESParents<span class="sc">$</span>PAA_CUR01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSESParents$STA_CUR01 and SSESParents$PAA_CUR01
t = 26.806, df = 34399, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1326796 0.1533818
sample estimates:
      cor 
0.1430463 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating database with some teacher data added</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>SSESParentsandTeachers <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  SSESParents <span class="sc">%&gt;%</span> <span class="fu">select</span>(Username_Std, Sgrade_Read_Lang, CohortID, STA_CUR01, STA_CUR02, STA_CUR03, STA_CUR04, STA_CUR05, STA_CUR06, STA_CUR07, STA_TOL01, STA_TOL02, PAA_CUR01, PAA_CUR02, PAA_CUR03, PAA_CUR04, PAA_CUR05, PAA_CUR06, PAA_CUR07, PAA_CUR08),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  SSEST <span class="sc">%&gt;%</span> <span class="fu">select</span>(Username_Std, TCA_CUR05, TCA_CUR06, TCA_CUR07),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Username_Std"</span>))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Not sure whether all this is necessary but was getting error messages about something not being numeric </span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For me, this runs without the conversion! </span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># SSESParentsandTeachers$Sgrade_Read_Lang&lt;-as.numeric(SSES$Sgrade_Read_Lang)</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$TCA_CUR05&lt;-as.numeric(SSES$TCA_CUR05)</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$TCA_CUR06&lt;-as.numeric(SSES$TCA_CUR06)</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$TCA_CUR07&lt;-as.numeric(SSES$TCA_CUR07)</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR01&lt;-as.numeric(SSES$PAA_CUR01)</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR02&lt;-as.numeric(SSES$PAA_CUR02)</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR03&lt;-as.numeric(SSES$PAA_CUR03)</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR04&lt;-as.numeric(SSES$PAA_CUR04)</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR05&lt;-as.numeric(SSES$PAA_CUR05)</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR06&lt;-as.numeric(SSES$PAA_CUR06)</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR07&lt;-as.numeric(SSES$PAA_CUR07)</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR08&lt;-as.numeric(SSES$PAA_CUR08)</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation test to check it works</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSESParentsandTeachers<span class="sc">$</span>Sgrade_Read_Lang, SSESParentsandTeachers<span class="sc">$</span>PAA_CUR01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSESParentsandTeachers$Sgrade_Read_Lang and SSESParentsandTeachers$PAA_CUR01
t = 15.436, df = 31258, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.07596468 0.09796804
sample estimates:
       cor 
0.08697697 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Database comparing reading test scores to parental, teacher and self-assessed like learning new things</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dfPT <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SSESParentsandTeachers<span class="sc">$</span>Sgrade_Read_Lang, SSESParentsandTeachers<span class="sc">$</span>TCA_CUR05, SSESParentsandTeachers<span class="sc">$</span>STA_CUR05, SSESParentsandTeachers<span class="sc">$</span>PAA_CUR05)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>PTTab<span class="ot">&lt;-</span><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(dfPT), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Database comparing reading test scores to parental, teacher and self-assessed like learning new things</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>corPTCur<span class="ot">&lt;-</span><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(dfPT), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(corPTCur) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Reading scores"</span>, <span class="st">"Teachers:CUR05"</span>, <span class="st">"Parents:CUR05"</span>, <span class="st">"Students:CUR05"</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(corPTCur) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Reading scores"</span>, <span class="st">"Teachers:CUR05"</span>, <span class="st">"Parents:CUR05"</span>, <span class="st">"Students:CUR05"</span>)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Now with added coefficients!</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(corPTCur, <span class="at">order =</span> <span class="st">'AOE'</span>, <span class="at">addCoef.col =</span> <span class="st">'black'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I didn't know you could do that!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This section isn't running for me - there seems to be a missing CohortID variable in the SSESSParentsandTeachers data frame</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed?</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#What happens to students' curiosity (CUR01) and questioning (CUR03) between the ages of 10 and 15? How well do parent perceptions correlate?</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Combining the data</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>PSCurDiff<span class="ot">&lt;-</span>SSESParentsandTeachers <span class="sc">%&gt;%</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CohortID) <span class="sc">%&gt;%</span> </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CohortID, PAA_CUR01, PAA_CUR03, STA_CUR01, STA_CUR03) <span class="sc">%&gt;%</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">CurSt =</span> <span class="fu">mean</span>(STA_CUR01, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">QuSt =</span> <span class="fu">mean</span>(STA_CUR03, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">CurPa =</span> <span class="fu">mean</span>(PAA_CUR01, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">QuPa =</span> <span class="fu">mean</span>(PAA_CUR03, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arrange</span>(CohortID)</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>PSCurDiff<span class="ot">&lt;-</span>PSCurDiff<span class="sc">%&gt;%</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>CohortID, <span class="at">names_to =</span> <span class="st">"GroupPerception"</span>, <span class="at">values_to =</span> <span class="st">"Scores"</span>)</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PSCurDiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   CohortID             GroupPerception Scores
   &lt;chr+lbl&gt;            &lt;chr&gt;            &lt;dbl&gt;
 1 ""                   CurSt           NaN   
 2 ""                   QuSt            NaN   
 3 ""                   CurPa           NaN   
 4 ""                   QuPa            NaN   
 5 "1" [Younger cohort] CurSt             4.12
 6 "1" [Younger cohort] QuSt              3.79
 7 "1" [Younger cohort] CurPa             4.23
 8 "1" [Younger cohort] QuPa              4.21
 9 "2" [Older cohort]   CurSt             4.13
10 "2" [Older cohort]   QuSt              3.55
11 "2" [Older cohort]   CurPa             4.01
12 "2" [Older cohort]   QuPa              3.80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>PSCurDiff <span class="ot">&lt;-</span> PSCurDiff[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), ]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PSCurDiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
  CohortID           GroupPerception Scores
  &lt;chr+lbl&gt;          &lt;chr&gt;            &lt;dbl&gt;
1 1 [Younger cohort] CurSt             4.12
2 1 [Younger cohort] QuSt              3.79
3 1 [Younger cohort] CurPa             4.23
4 1 [Younger cohort] QuPa              4.21
5 2 [Older cohort]   CurSt             4.13
6 2 [Older cohort]   QuSt              3.55
7 2 [Older cohort]   CurPa             4.01
8 2 [Older cohort]   QuPa              3.80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>PSCurDiff<span class="sc">$</span>new <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PSCurDiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  CohortID           GroupPerception Scores   new
  &lt;chr+lbl&gt;          &lt;chr&gt;            &lt;dbl&gt; &lt;dbl&gt;
1 1 [Younger cohort] CurSt             4.12     1
2 1 [Younger cohort] QuSt              3.79     2
3 1 [Younger cohort] CurPa             4.23     3
4 1 [Younger cohort] QuPa              4.21     4
5 2 [Older cohort]   CurSt             4.13     5
6 2 [Older cohort]   QuSt              3.55     6
7 2 [Older cohort]   CurPa             4.01     7
8 2 [Older cohort]   QuPa              3.80     8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This data plotted...</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PSCurDiff, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(GroupPerception, new), <span class="at">y=</span>Scores, <span class="at">fill=</span>CohortID))<span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Perceptions of Students' Curiosity in and out of School by Group"</span>)<span class="sc">+</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Perception of Students' Curiosity"</span>)<span class="sc">+</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Rating Group"</span>)<span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="fl">4.5</span>)) <span class="sc">+</span> </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'Age 10'</span>, <span class="st">'Age 15'</span>)) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Scores, <span class="dv">1</span>)), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This section isn't running for me - there seems to be a missing CohortID variable in the SSESSParentsandTeachers data frameSSESSParentsandTeachers data frame</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed?</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="co">#how much does the gap between CUR05 (like to learn new things) and CUR07 (love learning new things at school) grow for each site between ages 10 and 15?</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Slightly improved version...</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of Curiosity Drop by Group</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>PTSCurDiff<span class="ot">&lt;-</span>SSESParentsandTeachers <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CohortID) <span class="sc">%&gt;%</span> </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CohortID, PAA_CUR05, PAA_CUR07, TCA_CUR05, TCA_CUR07, STA_CUR05, STA_CUR07) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">CuriosityStudent =</span> <span class="fu">mean</span>(STA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">InSchCurStudent =</span> <span class="fu">mean</span>(STA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">CuriosityParents =</span> <span class="fu">mean</span>(PAA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">InSchCurParents =</span> <span class="fu">mean</span>(PAA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">CuriosityTeachers =</span> <span class="fu">mean</span>(TCA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">InSchCurTeachers =</span> <span class="fu">mean</span>(TCA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(CohortID)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PTSCurDiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  CohortID     CuriosityStudent InSchCurStudent CuriosityParents InSchCurParents
  &lt;chr+lbl&gt;               &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;
1 ""                     NaN             NaN              NaN             NaN   
2 "1" [Younge…             4.29            4.09             4.23            4.17
3 "2" [Older …             4.16            3.80             4.06            3.97
# ℹ 2 more variables: CuriosityTeachers &lt;dbl&gt;, InSchCurTeachers &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>PTSCurDiff<span class="ot">&lt;-</span>PTSCurDiff<span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>CohortID, <span class="at">names_to =</span> <span class="st">"GroupPerception"</span>, <span class="at">values_to =</span> <span class="st">"Scores"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>PTSCurDiff <span class="ot">&lt;-</span> PTSCurDiff[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), ]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>PTSCurDiff<span class="sc">$</span>new <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PTSCurDiff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
   CohortID           GroupPerception   Scores   new
   &lt;chr+lbl&gt;          &lt;chr&gt;              &lt;dbl&gt; &lt;dbl&gt;
 1 1 [Younger cohort] CuriosityStudent    4.29     1
 2 1 [Younger cohort] InSchCurStudent     4.09     2
 3 1 [Younger cohort] CuriosityParents    4.23     3
 4 1 [Younger cohort] InSchCurParents     4.17     4
 5 1 [Younger cohort] CuriosityTeachers   3.88     5
 6 1 [Younger cohort] InSchCurTeachers    3.87     6
 7 2 [Older cohort]   CuriosityStudent    4.16     7
 8 2 [Older cohort]   InSchCurStudent     3.80     8
 9 2 [Older cohort]   CuriosityParents    4.06     9
10 2 [Older cohort]   InSchCurParents     3.97    10
11 2 [Older cohort]   CuriosityTeachers   3.68    11
12 2 [Older cohort]   InSchCurTeachers    3.66    12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This data plotted...</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PTSCurDiff, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(GroupPerception, new), <span class="at">y=</span>Scores, <span class="at">fill=</span>CohortID))<span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Perceptions of Students' Curiosity in and out of School by Group"</span>)<span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Perception of Students' Curiosity"</span>)<span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Rating Group"</span>)<span class="sc">+</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="fl">4.5</span>)) <span class="sc">+</span> </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'Age 10'</span>, <span class="st">'Age 15'</span>)) <span class="sc">+</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Scores, <span class="dv">1</span>)), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This section isn't running for me - there seems to be a missing CohortID variable in the SSESSParentsandTeachers data frame</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Another graph, with the differences between 05 and 07 calculated for each group</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>PTSCurDiff2<span class="ot">&lt;-</span>SSESParentsandTeachers <span class="sc">%&gt;%</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CohortID) <span class="sc">%&gt;%</span> </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CohortID, PAA_CUR05, PAA_CUR07, TCA_CUR05, TCA_CUR07, STA_CUR05, STA_CUR07) <span class="sc">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanNS =</span> <span class="fu">mean</span>(STA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanS =</span> <span class="fu">mean</span>(STA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">SchDiffStu =</span> meanS<span class="sc">-</span>meanNS,</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanNSPa =</span> <span class="fu">mean</span>(PAA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanSPa =</span> <span class="fu">mean</span>(PAA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">SchDiffPrt =</span> meanSPa<span class="sc">-</span>meanNSPa,</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanNSTe =</span> <span class="fu">mean</span>(TCA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanSTe =</span> <span class="fu">mean</span>(TCA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">SchDiffTch =</span> meanSTe<span class="sc">-</span>meanNSTe,</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">students =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(meanS)) <span class="sc">%&gt;%</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(CohortID)</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co"># I imagine all these steps could be combined...</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>PTSCurDiff2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(PTSCurDiff2)</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>PTSCurDiff2<span class="ot">&lt;-</span>PTSCurDiff2<span class="sc">%&gt;%</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>meanS, <span class="sc">-</span>meanNS, <span class="sc">-</span>meanSPa, <span class="sc">-</span>meanNSPa, <span class="sc">-</span>meanSTe, <span class="sc">-</span>meanNSTe, <span class="sc">-</span>students)</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>PTSCurDiff2<span class="ot">&lt;-</span>PTSCurDiff2 <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>CohortID, <span class="at">names_to =</span> <span class="st">"Group"</span>, <span class="at">values_to =</span> <span class="st">"MeanDiffSch"</span>)</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PTSCurDiff2)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph showing perceptions of the difference between students' CUR05 (like to learn) and students' 07 (love to learn in school) for students, parents' and teachers</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PTSCurDiff2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>MeanDiffSch, <span class="at">fill=</span>CohortID))<span class="sc">+</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Just for interest, to show how the changes in various measures alighn with students' self-reported curiosity</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>CurByNumbers01<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STA_CUR01)<span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanRead =</span> <span class="fu">mean</span>(Sgrade_Read_Lang, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMath =</span> <span class="fu">mean</span>(Sgrade_Math, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanArt =</span> <span class="fu">mean</span>(Sgrade_Arts, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanInformed =</span> <span class="fu">mean</span>(STQM02507, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanFixed =</span> <span class="fu">mean</span>(STQM04403, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAnx =</span> <span class="fu">mean</span>(STQM04201, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanComp =</span> <span class="fu">mean</span>(STQM03804, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanRdBk =</span> <span class="fu">mean</span>(STQM03603, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanBks =</span> <span class="fu">mean</span>(STQM01001, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMotherListens =</span> <span class="fu">mean</span>(STQM02802A, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanFatherUnderstands =</span> <span class="fu">mean</span>(STQM02904B, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSatisfaction =</span> <span class="fu">mean</span>(STQM01901, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanTol =</span> <span class="fu">mean</span>(STA_TOL08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanCre =</span> <span class="fu">mean</span>(STA_CRE02, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanOpt =</span> <span class="fu">mean</span>(STA_OPT02, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanPer =</span> <span class="fu">mean</span>(STA_PER08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAnger =</span> <span class="fu">mean</span>(STA_EMO08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSES =</span> <span class="fu">mean</span>(STISEI_ST, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total =</span> <span class="fu">n</span>())</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>CurByNumbers01V2 <span class="ot">&lt;-</span> CurByNumbers01[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>), ]</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanRead))<span class="sc">+</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanBks))<span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanInformed))<span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanSatisfaction))<span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanTol))<span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanCre))<span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanOpt))<span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grouping students by curiosity value, separating by age</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>CurByNumbersAge01<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STA_CUR01, CohortID)<span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanRead =</span> <span class="fu">mean</span>(Sgrade_Read_Lang, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMath =</span> <span class="fu">mean</span>(Sgrade_Math, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanArt =</span> <span class="fu">mean</span>(Sgrade_Arts, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanInformed =</span> <span class="fu">mean</span>(STQM02507, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanFixed =</span> <span class="fu">mean</span>(STQM04403, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAnx =</span> <span class="fu">mean</span>(STQM04201, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanComp =</span> <span class="fu">mean</span>(STQM03804, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanRdBk =</span> <span class="fu">mean</span>(STQM03603, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanBks =</span> <span class="fu">mean</span>(STQM01001, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMotherListens =</span> <span class="fu">mean</span>(STQM02802A, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanFatherUnderstands =</span> <span class="fu">mean</span>(STQM02904B, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSatisfaction =</span> <span class="fu">mean</span>(STQM01901, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanTol =</span> <span class="fu">mean</span>(STA_TOL08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanCre =</span> <span class="fu">mean</span>(STA_CRE02, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanOpt =</span> <span class="fu">mean</span>(STA_OPT02, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanPer =</span> <span class="fu">mean</span>(STA_PER08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAnger =</span> <span class="fu">mean</span>(STA_EMO08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSES =</span> <span class="fu">mean</span>(STISEI_ST, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'STA_CUR01'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>CurByNumbersAge01V2 <span class="ot">&lt;-</span> CurByNumbersAge01[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>), ]</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbersAge01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>Total))<span class="sc">+</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> CohortID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbersAge01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanSatisfaction))<span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> CohortID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbersAge01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanRead))<span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> CohortID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-10.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I think SSES$STISEI_ST might be their socioeconomic indicator. I wanted to test the correlations between this, curiosity and reading scores. The linear model gives significant results but low R2 value.</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSES<span class="sc">$</span>STISEI_ST, SSES<span class="sc">$</span>Sgrade_Read_Lang)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSES$STISEI_ST and SSES$Sgrade_Read_Lang
t = 22.653, df = 41184, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1013880 0.1204658
sample estimates:
      cor 
0.1109371 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSES<span class="sc">$</span>STISEI_ST, SSES<span class="sc">$</span>STA_CUR01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSES$STISEI_ST and SSES$STA_CUR01
t = 13.114, df = 49263, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.05017656 0.06777595
sample estimates:
       cor 
0.05898084 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSES<span class="sc">$</span>Sgrade_Read_Lang, SSES<span class="sc">$</span>STA_CUR01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSES$Sgrade_Read_Lang and SSES$STA_CUR01
t = 17.013, df = 49571, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.06743323 0.08493690
sample estimates:
       cor 
0.07619093 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code># Attaching packages: easystats 0.6.0
✔ bayestestR  0.13.1   ✔ correlation 0.8.4 
✔ datawizard  0.9.0    ✔ effectsize  0.8.6 
✔ insight     0.19.6   ✔ modelbased  0.8.6 
✔ performance 0.10.8   ✔ parameters  0.21.3
✔ report      0.5.7    ✔ see         0.8.1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>CurSES<span class="ot">&lt;-</span><span class="fu">lm</span>(SSES<span class="sc">$</span>Sgrade_Read_Lang <span class="sc">~</span> SSES<span class="sc">$</span>STA_CUR01 <span class="sc">+</span> SSES<span class="sc">$</span>STISEI_ST, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) :
 extra argument 'na.rm' will be disregarded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the same thing, passing the dataframe to data, and avoiding the repeated $ gets rid of the warnings!</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>CurSES<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>SSES, Sgrade_Read_Lang <span class="sc">~</span> STA_CUR01 <span class="sc">+</span> STISEI_ST, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) :
 extra argument 'na.rm' will be disregarded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This looks like a neater way of doing it</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CurSES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sgrade_Read_Lang ~ STA_CUR01 + STISEI_ST, data = SSES, 
    na.rm = TRUE)

Residuals:
    Min      1Q  Median      3Q     Max 
-36.977  -6.352   1.164   7.249  19.144 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 28.72821    0.29667   96.84   &lt;2e-16 ***
STA_CUR01    0.73725    0.05658   13.03   &lt;2e-16 ***
STISEI_ST    0.69527    0.03184   21.84   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.16 on 41110 degrees of freedom
  (19897 observations deleted due to missingness)
Multiple R-squared:  0.01634,   Adjusted R-squared:  0.01629 
F-statistic: 341.4 on 2 and 41110 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(CurSES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict Sgrade_Read_Lang with
STA_CUR01 and STISEI_ST (formula: Sgrade_Read_Lang ~ STA_CUR01 + STISEI_ST).
The model explains a statistically significant and very weak proportion of
variance (R2 = 0.02, F(2, 41110) = 341.42, p &lt; .001, adj. R2 = 0.02). The
model's intercept, corresponding to STA_CUR01 = 0 and STISEI_ST = 0, is at
28.73 (95% CI [28.15, 29.31], t(41110) = 96.84, p &lt; .001). Within this model:

  - The effect of STA CUR01 is statistically significant and positive (beta =
0.74, 95% CI [0.63, 0.85], t(41110) = 13.03, p &lt; .001; Std. beta = 0.06, 95% CI
[0.05, 0.07])
  - The effect of STISEI ST is statistically significant and positive (beta =
0.70, 95% CI [0.63, 0.76], t(41110) = 21.84, p &lt; .001; Std. beta = 0.11, 95% CI
[0.10, 0.12])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
<section id="section-3" class="level3">
<h3 class="anchored" data-anchor-id="section-3"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There is no science test score. Oddly, though, teachers appear to have been asked to rate predict how well students would have done on a phantom science test.</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Item TCQM03003 is teachers' predictions about students' performance</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span>SSEST <span class="sc">%&gt;%</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(TCQM03001, TCQM03002, TCQM03003, TCQM03004, TCA_CUR05)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Removing item 6 (don't know)</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, TCQM03001 <span class="sc">!=</span> <span class="dv">6</span>) </span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, TCQM03002 <span class="sc">!=</span> <span class="dv">6</span>) </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, TCQM03003 <span class="sc">!=</span> <span class="dv">6</span>) </span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">subset</span>(df, TCQM03004 <span class="sc">!=</span> <span class="dv">6</span>) </span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>cor<span class="ot">&lt;-</span><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cor) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Predicted reading scores"</span>, <span class="st">"Predited maths Scores"</span>, <span class="st">"Predicted science scores"</span>, <span class="st">"Predicted arts scores"</span>, <span class="st">"Teacher's curiosity assessment"</span>)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(cor) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Predicted reading scores"</span>, <span class="st">"Predited maths Scores"</span>, <span class="st">"Predicted science scores"</span>, <span class="st">"Predicted arts scores"</span>, <span class="st">"Teacher's curiosity assessment"</span>)</span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor, <span class="at">order =</span> <span class="st">'AOE'</span>, <span class="at">addCoef.col =</span> <span class="st">'black'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Marginally higher correlation between teachers' perceptions of students' curiosity and their predictions about science test performance than between curiosity and performance in any other test</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>df, TCQM03003 <span class="sc">~</span> TCA_CUR05))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = TCQM03003 ~ TCA_CUR05, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.1473 -0.5396  0.0681  0.4604  3.2835 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.108757   0.019656   56.41   &lt;2e-16 ***
TCA_CUR05   0.607701   0.005051  120.32   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.8301 on 38902 degrees of freedom
  (34 observations deleted due to missingness)
Multiple R-squared:  0.2712,    Adjusted R-squared:  0.2712 
F-statistic: 1.448e+04 on 1 and 38902 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Teachers' curiosity ratings of students appears to explain around 27% of the variance in their ratings of their science ability</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-4" class="level3">
<h3 class="anchored" data-anchor-id="section-4"></h3>
</section>
<section id="potential-questions-to-explore" class="level3">
<h3 class="anchored" data-anchor-id="potential-questions-to-explore">Potential questions to explore</h3>
<p>• Does the language of the test matter? Is there a variation in response according to the language respondents have been given the test in (e.g.&nbsp;Houston seems to have been administered in English and Spanish; Ottawa in French and English)? Obviously there may be other differences between e.g.&nbsp;the French- and English-speaking cohorts in Ottawa, but I imagine it would be possible to control for these to a degree.</p>
<p>• Your finding that Finnish students aren’t very curious could be worth exploring further. They’re also the students who find science least interesting (according to CUR08). Is there a way to link cities/countries to their success in the last round of PISA? It would be interesting to try to explain those findings, especially where there are discrepancies…</p>
<ul>
<li>Sadly it looks like you can’t get city level data out of the main PISA data set.</li>
</ul>
<p>• Some of the Tolerance items correlate as well with the curiosity items as the curiosity items do with one another, esp TOL02 Ask questions about other cultures ; TOL05 Like hearing about other cultures and religions , which is potentially interesting, esp TOL05. I haven’t tested corplot yet, but it might be nice for showing this.</p>
<p>• An analysis of patterns of change of curiosity with age, comparing in school and out of school curiosity.</p>
</section>
</section>
<section id="accounting-for-the-drop-in-curiosity" class="level2">
<h2 class="anchored" data-anchor-id="accounting-for-the-drop-in-curiosity">Accounting for the drop in curiosity</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary ofSTA_CUR01 and wellbeing and belong (do add other variables!) for each site</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>Countrydrop<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CohortID, SiteID, STA_CUR01, st_wellbeing, st_belong)<span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID,CohortID )<span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanCur =</span> <span class="fu">mean</span>(STA_CUR01, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanWb =</span> <span class="fu">mean</span>(st_wellbeing, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanBel =</span> <span class="fu">mean</span>(st_belong, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SiteID'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the NA row</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>Countrydrop<span class="ot">&lt;-</span>Countrydrop[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot to create columns, side by side, for the years</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>Countrydrop<span class="ot">&lt;-</span><span class="fu">pivot_wider</span>(Countrydrop, <span class="at">names_from =</span> <span class="st">"CohortID"</span>, </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">"MeanCur"</span>,<span class="st">"MeanWb"</span>,<span class="st">"MeanBel"</span>))</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame of change in each variable across the two cohorts</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>Countrydrop<span class="ot">&lt;-</span>Countrydrop<span class="sc">%&gt;%</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Curchange =</span> MeanCur_1 <span class="sc">-</span> MeanCur_2,</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">WBchange =</span> MeanWb_1 <span class="sc">-</span> MeanWb_2,</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">Belchange =</span> MeanBel_1 <span class="sc">-</span> MeanBel_2)</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co"># We can then explore how well different models fit the drip (we could use the Bayesion approach below, but this is the frequentist approach)</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="co"># I have fitted two simple models here, we will have to play - mod1 - the change in curiosity is explained by change in well being; mod 2 - the change in curiosity is explained by the change in belonging</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> WBchange)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>mod2<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Belchange)</span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="co"># We can extract the R2 of each model</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01643493</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06529067</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And they are both terrible! Well being explains 1% of the variance, belonging 6%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>mod3<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Belchange <span class="sc">+</span> WBchange)</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1230042</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Together they explain 12% of the variance</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's try it again with the coopertation, empathy, trust, emotional control and optimism variables. </span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>Countrydrop<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID,CohortID)<span class="sc">%&gt;%</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanCur =</span> <span class="fu">mean</span>(STA_CUR01, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanCo =</span> <span class="fu">mean</span>(COO_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanEmp =</span> <span class="fu">mean</span>(EMP_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanTr =</span> <span class="fu">mean</span>(TRU_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanEmC =</span> <span class="fu">mean</span>(EMO_WLE_ADJ, <span class="at">na.rm=</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanOpt =</span> <span class="fu">mean</span>(OPT_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanStr =</span> <span class="fu">mean</span>(STR_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAss =</span> <span class="fu">mean</span>(ASS_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanEn =</span> <span class="fu">mean</span>(ENE_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSoc =</span> <span class="fu">mean</span>(SOC_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanCre =</span> <span class="fu">mean</span>(CRE_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanTol =</span> <span class="fu">mean</span>(TOL_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanPer =</span> <span class="fu">mean</span>(PER_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanRes =</span> <span class="fu">mean</span>(RES_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSel =</span> <span class="fu">mean</span>(SEL_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanEff =</span> <span class="fu">mean</span>(EFF_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMot =</span> <span class="fu">mean</span>(MOT_WLE_ADJ, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">%&gt;%</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CohortID, SiteID, MeanCur, MeanCo, </span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>         MeanEmp, MeanTr, MeanEmC, MeanOpt,</span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>         MeanStr, MeanAss, MeanEn, MeanSoc, MeanCre,</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>         MeanTol, MeanPer, MeanRes, MeanSel,</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>         MeanEff, MeanMot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'SiteID'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the NA row</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>Countrydrop<span class="ot">&lt;-</span>Countrydrop[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot to create columns, side by side, for the years</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>Countrydrop<span class="ot">&lt;-</span><span class="fu">pivot_wider</span>(Countrydrop, <span class="at">names_from =</span> <span class="st">"CohortID"</span>, </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">"MeanCur"</span>,<span class="st">"MeanCo"</span>,<span class="st">"MeanEmp"</span>,</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"MeanTr"</span>,<span class="st">"MeanEmC"</span>,<span class="st">"MeanOpt"</span>,</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"MeanStr"</span>, <span class="st">"MeanAss"</span>, <span class="st">"MeanEn"</span>,</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"MeanSoc"</span>, <span class="st">"MeanCre"</span>, <span class="st">"MeanTol"</span>,</span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"MeanPer"</span>, <span class="st">"MeanRes"</span>, <span class="st">"MeanSel"</span>,</span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>                                         <span class="st">"MeanEff"</span>,<span class="st">"MeanMot"</span>))</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame of change in each variable across the two cohorts</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>Countrydrop<span class="ot">&lt;-</span>Countrydrop<span class="sc">%&gt;%</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Curchange =</span> MeanCur_1 <span class="sc">-</span> MeanCur_2,</span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cochange =</span> MeanCo_1 <span class="sc">-</span> MeanCo_2,</span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">Empchange =</span> MeanEmp_1 <span class="sc">-</span> MeanEmp_2,</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">Trchange =</span> MeanTr_1 <span class="sc">-</span> MeanTr_2,</span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">EmCchange =</span> MeanEmC_1 <span class="sc">-</span> MeanEmC_2,</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">Optchange =</span> MeanOpt_1 <span class="sc">-</span> MeanOpt_2,</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">Strchange =</span> MeanStr_1 <span class="sc">-</span> MeanStr_2,</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">Asschange =</span> MeanAss_1 <span class="sc">-</span>MeanAss_2,</span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">Enchange =</span> MeanEn_1 <span class="sc">-</span> MeanEn_2,</span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">Socchange =</span> MeanSoc_1 <span class="sc">-</span> MeanSoc_2,</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">Crechange =</span> MeanCre_1 <span class="sc">-</span> MeanCre_2,</span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>         <span class="at">Tolchange =</span> MeanTol_1 <span class="sc">-</span> MeanTol_2,</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">Perchange =</span> MeanPer_1 <span class="sc">-</span> MeanPer_2,</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">Reschange =</span> MeanRes_1 <span class="sc">-</span> MeanRes_2,</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">Selchange =</span> MeanSel_1 <span class="sc">-</span> MeanSel_2,</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">Effchange =</span> MeanEff_1 <span class="sc">-</span> MeanEff_2,</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">Motchange =</span> MeanMot_1 <span class="sc">-</span> MeanMot_2)</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Doing the models</span></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>modCo<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Cochange)</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>modEmp<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Empchange)</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>modTr<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Trchange)</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>modEmC<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> EmCchange)</span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>modOpt<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Optchange)</span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>modStr<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Strchange)</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>modAss<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Asschange)</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>modEn<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Enchange)</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>modSoc<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Socchange)</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>modCre<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Crechange)</span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>modTol<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Tolchange)</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>modPer<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Perchange)</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>modRes<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Reschange)</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>modSel<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Selchange)</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>modEff<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Effchange)</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>modMot<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Motchange)</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Cooperation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cooperation"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modCo)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01953941</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Empathy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Empathy"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modEmp)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02743004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Trust"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Trust"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modTr)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.063074</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Emotional Control"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Emotional Control"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modEmC)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.002906867</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Optimism"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Optimism"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modOpt)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4083756</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Stress resistance/resilience"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Stress resistance/resilience"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modStr)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1761187</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Assertiveness"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Assertiveness"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modAss)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0940386</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Energy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Energy"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modEn)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1280641</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Sociability Optimism"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Sociability Optimism"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSoc)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.143767</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Creativity Optimism"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Creativity Optimism"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modCre)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1244793</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Tolerance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Tolerance"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modTol)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08861503</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Perseverance/Persistence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Perseverance/Persistence"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modPer)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0003049348</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Responsibility"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Responsibility"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modRes)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0003589303</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Self Control"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Self Control"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modSel)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1159943</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Self efficacy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Self efficacy"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modEff)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09946103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Achievement motivation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Achievement motivation"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modMot)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01623592</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interesting - the change in optimism item (STA_OPT01) seems quite useful here - it explains 41% of the variance! And trust accoutns for 33%. Let's run them together</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>mod6<span class="ot">&lt;-</span>mod5<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>Countrydrop, Curchange <span class="sc">~</span> Optchange <span class="sc">+</span> Trchange)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod6)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.542675</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># That gives us 48% of the variance</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Countrydrop, <span class="fu">aes</span>(<span class="at">y =</span> Curchange, <span class="at">x=</span>Optchange))<span class="sc">+</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Countrydrop, <span class="fu">aes</span>(<span class="at">y =</span> Curchange, <span class="at">x=</span>Trchange))<span class="sc">+</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is an attempt to run the multiple models not in Bayesian form, but normal multiple models, which should be less processor intensive</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the MuMIn package</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>Subset<span class="ot">&lt;-</span>Countrydrop<span class="sc">%&gt;%</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Curchange, Cochange, Empchange)<span class="co"># Trchange, EmCchange, Optchange,</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `SiteID`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>         <span class="co">#Strchange, Asschange,Enchange, Socchange, Crechange, </span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>         <span class="co">#Tolchange, Perchange, Reschange, Selchange, Effchange, Motchange)</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="co"># To speed up rendering</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">na.action =</span> <span class="st">"na.fail"</span>)</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>modelslm<span class="ot">&lt;-</span><span class="fu">lm</span>(Curchange <span class="sc">~</span> ., <span class="at">data =</span> Subset)</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>comp<span class="ot">&lt;-</span><span class="fu">dredge</span>(modelslm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Fixed term is "(Intercept)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>comp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: lm(formula = Curchange ~ ., data = Subset)
---
Model selection table 
    (Intrc)      Cchng     Empch SitID df logLik AICc delta
5  0.025440                          + 11    Inf -Inf      
6  0.017810  0.0003950               + 11    Inf -Inf      
7  0.021690            0.0003179     + 11    Inf -Inf      
8  0.050210 -0.0029000 0.0026520     + 11    Inf -Inf      
1 -0.008116                             2  7.181 -8.6   Inf
3 -0.010120            0.0007518        3  7.320 -4.6   Inf
2 -0.028730  0.0008979                  3  7.280 -4.6   Inf
4 -0.014470  0.0002025 0.0006423        4  7.322  1.4   Inf
Models ranked by AICc(x) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the best model</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>models<span class="ot">&lt;-</span><span class="fu">get.models</span>(comp, <span class="at">subset =</span> <span class="dv">1</span>)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>models</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`5`

Call:
lm(formula = Curchange ~ SiteID + 1, data = Subset)

Coefficients:
(Intercept)     SiteID02     SiteID03     SiteID04     SiteID06     SiteID07  
  0.0254363   -0.1858853   -0.1608513   -0.1994147   -0.1002353    0.1279825  
   SiteID08     SiteID09     SiteID10     SiteID11  
  0.0107502    0.1528593   -0.0007003    0.0199734  


attr(,"rank")
function (x) 
do.call("rank", list(x))
&lt;environment: 0x15d9380e0&gt;
attr(,"call")
AICc(x)
attr(,"class")
[1] "function"     "rankFunction"
attr(,"beta")
[1] "none"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)           Cochange           Empchange         SiteID 
 Min.   :-0.028731   Min.   :-0.002900   Min.   :0.000318   +   :4  
 1st Qu.:-0.011205   1st Qu.:-0.000573   1st Qu.:0.000561   NA's:4  
 Median : 0.004845   Median : 0.000299   Median :0.000697           
 Mean   : 0.006713   Mean   :-0.000351   Mean   :0.001091           
 3rd Qu.: 0.022627   3rd Qu.: 0.000521   3rd Qu.:0.001227           
 Max.   : 0.050209   Max.   : 0.000898   Max.   :0.002652           
                     NA's   :4           NA's   :4                  
       df           logLik           AICc            delta         weight   
 Min.   : 2.0   Min.   :7.181   Min.   :  -Inf   Min.   :Inf   Min.   : NA  
 1st Qu.: 3.0   1st Qu.:7.310   1st Qu.:  -Inf   1st Qu.:Inf   1st Qu.: NA  
 Median : 7.5   Median :  Inf   Median :  -Inf   Median :Inf   Median : NA  
 Mean   : 7.0   Mean   :  Inf   Mean   :  -Inf   Mean   :Inf   Mean   :NaN  
 3rd Qu.:11.0   3rd Qu.:  Inf   3rd Qu.:-4.620   3rd Qu.:Inf   3rd Qu.: NA  
 Max.   :11.0   Max.   :  Inf   Max.   : 1.355   Max.   :Inf   Max.   : NA  
                                                 NA's   :4     NA's   :8    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here model 512 is suggested as the best</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 512 is lm(formula = Curchange ~ Asschange + Cochange + Crechange + Effchange + EmCchange + Empchange + Enchange + Motchange + Optchange + 1, data = Subset)</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We can also apply the same approach to predicting the STA_CURO1 variable itself, e.g. for the younger cohort (which I think is 1!)</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>SESSsubset<span class="ot">&lt;-</span>Countrydrop<span class="sc">%&gt;%</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(MeanCur_1, MeanCo_1, MeanEmp_1)<span class="sc">%&gt;%</span> <span class="co">#, MeanTr_1, MeanEmC_1, MeanOpt_1,</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>        <span class="co"># MeanStr_1, MeanAss_1, MeanEn_1, MeanSoc_1, MeanCre_1, MeanTol_1,</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># MeanPer_1, MeanRes_1, MeanSel_1, MeanEff_1, MeanMot_1) to speed up rendering</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Adding missing grouping variables: `SiteID`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>modelslm<span class="ot">&lt;-</span><span class="fu">lm</span>(MeanCur_1 <span class="sc">~</span> ., <span class="at">data =</span> SESSsubset)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>comp<span class="ot">&lt;-</span><span class="fu">dredge</span>(modelslm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Fixed term is "(Intercept)"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>comp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: lm(formula = MeanCur_1 ~ ., data = SESSsubset)
---
Model selection table 
  (Intrc)    MeanC_1    MnEmp_1 SitID df logLik  AICc delta
5   4.172                           + 11    Inf  -Inf      
6   4.226 -9.014e-05                + 11    Inf  -Inf      
7   4.225            -8.747e-05     + 11    Inf  -Inf      
8   4.204  1.024e-03 -1.081e-03     + 11    Inf  -Inf      
1   4.121                              2  8.963 -12.2   Inf
3   3.341             1.296e-03        3  9.773  -9.5   Inf
2   3.223  1.434e-03                   3  9.595  -9.2   Inf
4   3.100  7.259e-04  9.425e-04        4  9.888  -3.8   Inf
Models ranked by AICc(x) </code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the best model # 512</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>models<span class="ot">&lt;-</span><span class="fu">get.models</span>(comp, <span class="at">subset =</span> <span class="cn">TRUE</span>)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>models</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`5`

Call:
lm(formula = MeanCur_1 ~ SiteID + 1, data = SESSsubset)

Coefficients:
(Intercept)     SiteID02     SiteID03     SiteID04     SiteID06     SiteID07  
   4.171509    -0.143144    -0.063043    -0.082240    -0.264385    -0.108467  
   SiteID08     SiteID09     SiteID10     SiteID11  
   0.031239     0.081651     0.049306    -0.005944  


$`6`

Call:
lm(formula = MeanCur_1 ~ MeanCo_1 + SiteID + 1, data = SESSsubset)

Coefficients:
(Intercept)     MeanCo_1     SiteID02     SiteID03     SiteID04     SiteID06  
  4.226e+00   -9.014e-05   -1.443e-01   -6.140e-02   -7.984e-02   -2.640e-01  
   SiteID07     SiteID08     SiteID09     SiteID10     SiteID11  
 -1.082e-01    3.571e-02    8.127e-02    5.158e-02           NA  


$`7`

Call:
lm(formula = MeanCur_1 ~ MeanEmp_1 + SiteID + 1, data = SESSsubset)

Coefficients:
(Intercept)    MeanEmp_1     SiteID02     SiteID03     SiteID04     SiteID06  
  4.225e+00   -8.747e-05   -1.465e-01   -6.593e-02   -8.443e-02   -2.652e-01  
   SiteID07     SiteID08     SiteID09     SiteID10     SiteID11  
 -1.097e-01    3.184e-02    8.316e-02    4.741e-02           NA  


$`8`

Call:
lm(formula = MeanCur_1 ~ MeanCo_1 + MeanEmp_1 + SiteID + 1, data = SESSsubset)

Coefficients:
(Intercept)     MeanCo_1    MeanEmp_1     SiteID02     SiteID03     SiteID04  
   4.204467     0.001024    -0.001081    -0.171899    -0.117387    -0.136564  
   SiteID06     SiteID07     SiteID08     SiteID09     SiteID10     SiteID11  
  -0.278300    -0.126241    -0.012115     0.104606           NA           NA  


$`1`

Call:
lm(formula = MeanCur_1 ~ 1, data = SESSsubset)

Coefficients:
(Intercept)  
      4.121  


$`3`

Call:
lm(formula = MeanCur_1 ~ MeanEmp_1 + 1, data = SESSsubset)

Coefficients:
(Intercept)    MeanEmp_1  
   3.341472     0.001296  


$`2`

Call:
lm(formula = MeanCur_1 ~ MeanCo_1 + 1, data = SESSsubset)

Coefficients:
(Intercept)     MeanCo_1  
   3.223482     0.001434  


$`4`

Call:
lm(formula = MeanCur_1 ~ MeanCo_1 + MeanEmp_1 + 1, data = SESSsubset)

Coefficients:
(Intercept)     MeanCo_1    MeanEmp_1  
  3.0996575    0.0007259    0.0009425  


attr(,"rank")
function (x) 
do.call("rank", list(x))
&lt;environment: 0x14c0d69e8&gt;
attr(,"call")
AICc(x)
attr(,"class")
[1] "function"     "rankFunction"
attr(,"beta")
[1] "none"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>models[[<span class="st">"512"</span>]][[<span class="st">"call"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lm(formula = MeanCur_1 ~ MeanAss_1 + MeanCo_1 + MeanCre_1 + MeanEff_1 + </span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co">#    MeanEmC_1 + MeanEmp_1 + MeanEn_1 + MeanMot_1 + MeanOpt_1 + </span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    1, data = SESSsubset)</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="co">#mod&lt;-lm(formula = MeanCur_1 ~ MeanAss_1 + MeanCo_1 + MeanCre_1 + MeanEff_1 + #MeanEmC_1 + MeanEmp_1 + MeanEn_1 + MeanMot_1 + MeanOpt_1 + 1, data = SESSsubset)</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(mod)</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Which has an R2 of 1!</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a><span class="co"># To get the nested models list as a dataframe</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>modsdataframe <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">do.call</span>(cbind, models))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in (function (..., deparse.level = 1) : number of rows of result is not
a multiple of vector length (arg 5)</code></pre>
</div>
</div>
</section>
<section id="an-alternative-principal-component-analysis" class="level2">
<h2 class="anchored" data-anchor-id="an-alternative-principal-component-analysis">An alternative: Principal component analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: true</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Attempting Principle component analysis</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="co"># See here: https://www.datacamp.com/tutorial/pca-analysis-r</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove non-numeric column and normalize with scale</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>PCAset<span class="ot">&lt;-</span>SESSsubset<span class="sc">%&gt;%</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()<span class="sc">%&gt;%</span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>SiteID)<span class="sc">%&gt;%</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale</span>()</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a correlation matrix</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>corr_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(PCAset)</span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(corr_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the PCA</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>data.pca <span class="ot">&lt;-</span> <span class="fu">princomp</span>(corr_matrix)</span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data.pca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2 Comp.3
Standard deviation     0.4182690 0.2276612      0
Proportion of Variance 0.7714528 0.2285472      0
Cumulative Proportion  0.7714528 1.0000000      1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Looking at cumulative proportion explained: Compl1 is 0.5635163 alone then with Comp2: 0.8450691 and with Comp 3 0.92844431</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="co"># let's find out what those three components are:</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>data.pca<span class="sc">$</span>loadings[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Comp.1      Comp.2    Comp.3
MeanCur_1  0.7161013  0.01396591 0.6978567
MeanCo_1  -0.5411252  0.64262987 0.5424116
MeanEmp_1 -0.4408883 -0.76604948 0.4677454</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We can plot a Scree plot to see how many components we might need</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(data.pca, <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The elbow looks like at 4</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co"># produce a biplot</span></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_var</span>(data.pca, <span class="at">col.var =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-18-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variables that are grouped together are positively correlated to each other</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co"># the higher the distance between the variable and the origin, the better represented that variable is.</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># variables that are negatively correlated are displayed to the opposite sides of the biplot’s origin</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We have a cluster of emotional like traits at the bottom left (empathy, sociability, emotional control), and motivational change at the bottom right (Efficacy, perseverance, optimism), and curiosity on its own a bit (with energy and assertiveness). This could be a more interesting approach to analysis</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a><span class="co"># I tried Exploratory factor analysis, and the data set didn't meet the suitability test - perhaps principal component analysis is the way to go</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="structural-equation-modelling" class="level2">
<h2 class="anchored" data-anchor-id="structural-equation-modelling">Structural equation modelling</h2>
<p>I have just learned how to do structural equation modelling, which builds a model of some output variable, based on a number of independent variables, which might be useful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we tell lavaan what we want to model, e.g.:</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">"STA_CUR01 ~ SiteID + Gender_Std + st_anxtest"</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">sem</span>(model, <span class="at">data=</span>SSES)</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         4

                                                  Used       Total
  Number of observations                         57482       61010

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  STA_CUR01 ~                                         
    SiteID           -0.001    0.001   -0.501    0.616
    Gender_Std       -0.074    0.008   -9.925    0.000
    st_anxtest        0.002    0.000    6.613    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .STA_CUR01         0.792    0.005  169.532    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit, <span class="at">whatLabels =</span> <span class="st">"Estimate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I like the diagram it produces - I'm going to try using this</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Another thing one can do with <code>lavaan</code> is to propose some latent variables and investigate their explanatory effectiveness. We might propose a psychological latent variable (lv1) composed of (<code>st_wellbeing</code> and <code>st_anxtest</code>) and a social environment latent variable (lv2) composed of (<code>st_bully</code>, <code>st_friends</code>, <code>st_belong</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we tell lavaan what we want to model, note =~ indicates latent variables</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">"lv1 =~st_wellbeing + st_anxtest</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="st">        lv2 =~ st_bully + st_friends + st_belong</span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="st">        STA_CUR01 ~ lv1 + lv2"</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">sem</span>(model, <span class="at">data=</span>SSES)</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 135 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

                                                  Used       Total
  Number of observations                         56955       61010

Model Test User Model:
                                                      
  Test statistic                              2247.287
  Degrees of freedom                                 7
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lv1 =~                                              
    st_wellbeing      1.000                           
    st_anxtest       -0.371    0.009  -43.506    0.000
  lv2 =~                                              
    st_bully          1.000                           
    st_friends       -1.977    0.033  -60.394    0.000
    st_belong        -2.831    0.047  -60.336    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  STA_CUR01 ~                                         
    lv1               0.009    0.001    8.165    0.000
    lv2              -0.021    0.003   -7.939    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lv1 ~~                                              
    lv2             -28.570    0.522  -54.757    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .st_wellbeing     82.202    2.223   36.983    0.000
   .st_anxtest      162.545    1.008  161.219    0.000
   .st_bully        139.913    0.858  163.038    0.000
   .st_friends      112.587    0.850  132.439    0.000
   .st_belong        52.712    1.087   48.507    0.000
   .STA_CUR01         0.766    0.005  166.817    0.000
    lv1              99.204    2.371   41.841    0.000
    lv2              14.524    0.446   32.545    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit, <span class="at">whatLabels =</span> <span class="st">"Estimate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Neither of the proposed latent variables seem to have much influence!</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a><span class="co"># An alternative is to the use the items to construct latent variables for e.g. cooperation, empathy, emotional control</span></span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">"lv1 =~STA_COO01 + STA_COO02 + STA_COO03+ STA_COO04 + STA_COO05   </span></span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a><span class="st">              +STA_COO06 + STA_COO07</span></span>
<span id="cb198-7"><a href="#cb198-7" aria-hidden="true" tabindex="-1"></a><span class="st">        lv2 =~ STA_EMP01 + STA_EMP02 + STA_EMP03+ STA_EMP04 + STA_EMP05   </span></span>
<span id="cb198-8"><a href="#cb198-8" aria-hidden="true" tabindex="-1"></a><span class="st">              +STA_EMP06 + STA_EMP07</span></span>
<span id="cb198-9"><a href="#cb198-9" aria-hidden="true" tabindex="-1"></a><span class="st">        lv3 =~ STA_EMO01 + STA_EMO02 + STA_EMO03+ STA_EMO04 + STA_EMO05   </span></span>
<span id="cb198-10"><a href="#cb198-10" aria-hidden="true" tabindex="-1"></a><span class="st">              +STA_EMO06 + STA_EMO07</span></span>
<span id="cb198-11"><a href="#cb198-11" aria-hidden="true" tabindex="-1"></a><span class="st">        STA_CUR01 ~ lv1 + lv2 +lv3"</span></span>
<span id="cb198-12"><a href="#cb198-12" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">sem</span>(model, <span class="at">data=</span>SSES)</span>
<span id="cb198-13"><a href="#cb198-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 54 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        49

                                                  Used       Total
  Number of observations                         58236       61010

Model Test User Model:
                                                       
  Test statistic                              57854.957
  Degrees of freedom                                204
  P-value (Chi-square)                            0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lv1 =~                                              
    STA_COO01         1.000                           
    STA_COO02         0.974    0.008  124.516    0.000
    STA_COO03         0.998    0.008  122.842    0.000
    STA_COO04        -0.604    0.009  -67.529    0.000
    STA_COO05         0.895    0.007  122.874    0.000
    STA_COO06         1.161    0.009  136.313    0.000
    STA_COO07         1.214    0.009  138.124    0.000
  lv2 =~                                              
    STA_EMP01         1.000                           
    STA_EMP02         0.741    0.008   87.481    0.000
    STA_EMP03         1.030    0.010   98.555    0.000
    STA_EMP04         1.163    0.011  105.321    0.000
    STA_EMP05         0.938    0.011   87.553    0.000
    STA_EMP06         1.129    0.011  106.165    0.000
    STA_EMP07         1.043    0.011   98.649    0.000
  lv3 =~                                              
    STA_EMO01         1.000                           
    STA_EMO02         1.141    0.012   94.318    0.000
    STA_EMO03        -1.537    0.016  -96.644    0.000
    STA_EMO04         1.378    0.014   97.529    0.000
    STA_EMO05        -1.198    0.014  -85.592    0.000
    STA_EMO06        -0.974    0.013  -76.157    0.000
    STA_EMO07         0.960    0.012   80.212    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  STA_CUR01 ~                                         
    lv1               0.216    0.023    9.283    0.000
    lv2               0.468    0.024   19.174    0.000
    lv3              -0.120    0.009  -13.344    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lv1 ~~                                              
    lv2               0.231    0.003   91.113    0.000
    lv3               0.130    0.002   64.195    0.000
  lv2 ~~                                              
    lv3               0.097    0.002   53.036    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .STA_COO01         0.411    0.003  150.258    0.000
   .STA_COO02         0.449    0.003  153.010    0.000
   .STA_COO03         0.498    0.003  153.919    0.000
   .STA_COO04         0.982    0.006  167.558    0.000
   .STA_COO05         0.400    0.003  153.902    0.000
   .STA_COO06         0.430    0.003  144.313    0.000
   .STA_COO07         0.440    0.003  142.470    0.000
   .STA_EMP01         0.538    0.004  152.440    0.000
   .STA_EMP02         0.534    0.003  160.668    0.000
   .STA_EMP03         0.679    0.004  155.390    0.000
   .STA_EMP04         0.656    0.004  150.407    0.000
   .STA_EMP05         0.853    0.005  160.641    0.000
   .STA_EMP06         0.596    0.004  149.638    0.000
   .STA_EMP07         0.693    0.004  155.332    0.000
   .STA_EMO01         0.928    0.006  155.821    0.000
   .STA_EMO02         0.593    0.004  140.150    0.000
   .STA_EMO03         0.896    0.007  134.005    0.000
   .STA_EMO04         0.667    0.005  131.047    0.000
   .STA_EMO05         1.120    0.007  152.995    0.000
   .STA_EMO06         1.193    0.007  159.725    0.000
   .STA_EMO07         0.951    0.006  157.329    0.000
   .STA_CUR01         0.696    0.004  165.012    0.000
    lv1               0.287    0.004   80.782    0.000
    lv2               0.251    0.004   67.170    0.000
    lv3               0.288    0.005   55.349    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit, <span class="at">whatLabels =</span> <span class="st">"Estimate"</span>, <span class="at">rotation=</span><span class="dv">2</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.8</span>, <span class="at">sizeMan =</span><span class="dv">3</span>, <span class="st">"std"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interesting that the empathy latent variable has the highest loading here, and that the loading of the emotion latent variable is negative!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="bayesian-multiple-model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-multiple-model-fitting">Bayesian Multiple Model Fitting</h3>
<p>This approach is not recommended:</p>
<blockquote class="blockquote">
<p>“Let the computer find out” is a poor strategy and usually reflects the fact that the researcher did not bother to think clearly about the problem of interest and its scientific setting” - <span class="citation" data-cites="anderson2004model">(<a href="#ref-anderson2004model" role="doc-biblioref"><strong>anderson2004model?</strong></a>)</span></p>
</blockquote>
<p>But the <code>BayesFactor</code> package allows you to generate multiple models, based on different combinations of variables in a data set and compare their predictive power.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset of the data frame, including variables we want to include in model building (+ need to remove NAs) </span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>SESSsubset<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(STA_CUR01, SiteID, Gender_Std, STA_ASS01,STA_EMO01,</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>         STA_ENE01,STA_OPT01)<span class="sc">%&gt;%</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a><span class="co"># call regressionBD to create different models for the STA_CUR01 variable using all the other variables in the data frame </span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>models<span class="ot">&lt;-</span><span class="fu">regressionBF</span>(STA_CUR01 <span class="sc">~</span> ., <span class="at">data =</span> SESSsubset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the relevant part of the output</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>output<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(models<span class="sc">@</span>bayesFactor)</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the output</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>output<span class="ot">&lt;-</span>output<span class="sc">%&gt;%</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(output<span class="sc">$</span>bf))</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 bf
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01 1943.687
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01             1920.492
Gender_Std + STA_ASS01 + STA_ENE01 + STA_OPT01             1892.657
Gender_Std + STA_ASS01 + STA_ENE01                         1881.470
STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01              1831.107
STA_ASS01 + STA_EMO01 + STA_ENE01                          1796.292
                                                                  error
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01 1.193456e-04
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01             2.369470e-07
Gender_Std + STA_ASS01 + STA_ENE01 + STA_OPT01             4.057525e-07
Gender_Std + STA_ASS01 + STA_ENE01                         1.154868e-05
STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01              6.819002e-05
STA_ASS01 + STA_EMO01 + STA_ENE01                          1.423306e-05
                                                                               time
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01 Tue Nov 14 16:41:29 2023
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01             Tue Nov 14 16:41:29 2023
Gender_Std + STA_ASS01 + STA_ENE01 + STA_OPT01             Tue Nov 14 16:41:29 2023
Gender_Std + STA_ASS01 + STA_ENE01                         Tue Nov 14 16:41:29 2023
STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01              Tue Nov 14 16:41:29 2023
STA_ASS01 + STA_EMO01 + STA_ENE01                          Tue Nov 14 16:41:29 2023
                                                                   code
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01 64815f158fcb
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01             6481680fca6a
Gender_Std + STA_ASS01 + STA_ENE01 + STA_OPT01             64816d05b568
Gender_Std + STA_ASS01 + STA_ENE01                         64817350272e
STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01              648120c08554
STA_ASS01 + STA_EMO01 + STA_ENE01                          64814ff3262d</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The column we are interested in is bf, the Bayes Factor, which is a ratio of the likelihood of different models to a intercept only model (i.e. a horizontal line). So the best model with the variables I input is: STA_CUR01 ~ Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01, which has a bf of 1943 so us 1943 times better than an intercept only model</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>output<span class="ot">&lt;-</span>output<span class="sc">%&gt;%</span></span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()<span class="sc">%&gt;%</span></span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bf<span class="sc">&gt;</span><span class="dv">100</span>) <span class="co"># Get rid of NAs and there are lots of combinations of models so only plot the best!</span></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(output, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(<span class="fu">rownames</span>(output), <span class="sc">-</span> bf), <span class="at">y=</span>bf, <span class="at">fill=</span><span class="fu">rownames</span>(output)))<span class="sc">+</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It is interesting to note how explanatory powerful even quite simple models are: STA_ASS01 + STA_ENE01 does surprisingly well! It explains 91% of the more complex Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="co"># I get an error message when I try to load the BayesFactor package for some reason. I'll keep trying with it... Interesting finding about the fit with assertiveness and energy though!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>