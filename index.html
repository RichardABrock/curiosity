<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Reid and Richard Brock">

<title>OECD curiosity analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="OECDCuriosity2_files/libs/clipboard/clipboard.min.js"></script>
<script src="OECDCuriosity2_files/libs/quarto-html/quarto.js"></script>
<script src="OECDCuriosity2_files/libs/quarto-html/popper.min.js"></script>
<script src="OECDCuriosity2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="OECDCuriosity2_files/libs/quarto-html/anchor.min.js"></script>
<link href="OECDCuriosity2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="OECDCuriosity2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="OECDCuriosity2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="OECDCuriosity2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="OECDCuriosity2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">OECD curiosity analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Chris Reid and Richard Brock </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="oecd-curiosity-analysis" class="level2">
<h2 class="anchored" data-anchor-id="oecd-curiosity-analysis">OECD curiosity analysis</h2>
<p>I have added the appendix with some item descriptions in the OneDrive folder <a href="https://emckclac-my.sharepoint.com/:x:/g/personal/k1765032_kcl_ac_uk/EbSMrXCv_-dEqTqZM5sZoUQBW_deyV-40VYQ5oGRsdWlLw?e=2pRgv6">here</a> (as I keep forgetting what the item codes refer to!). I have also added the student, parent and school surveys to this <a href="https://emckclac-my.sharepoint.com/:f:/g/personal/k1765032_kcl_ac_uk/Ekw-k-oSk7lBv2XVJR6KpJ4BHKTxxWWgGYsZ9Di1lVysqQ?e=JBRhET">folder</a>, and the code books <a href="https://emckclac-my.sharepoint.com/:f:/g/personal/k1765032_kcl_ac_uk/EuupjG39CvtJs_cuOLEpEQUBlfu6orLUfVOVMaXweWvNPA?e=wq7Xrk">here</a>.</p>
<p>We can include code snippets using the code blocks:</p>
<p>We need to load the packages and data but don’t need to run this each time</p>
<p>!! i<strong><em>n fact, this code won’t run for you, as it tries to load the SSES file from a location on my laptop. So I would select the install packages lines and library lines, and run them - you will have the SSES dataframe loaded anyway so the other code blocks should run for you</em></strong> !!</p>
</section>
<section id="weighting" class="level2">
<h2 class="anchored" data-anchor-id="weighting">Weighting</h2>
<p>As we are getting into the analysis it is time to add the weightings. There is an overall weighted curiosity item (<code>CUR_WLE_ADJ</code>) but I assume that combines all five curiosity items. We might want to have a weighted version of just one item, e.g <code>STA_CUR01</code>. We can use the packages <code>survey</code> and <code>srvyr</code>, like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See this helpful video: https://www.youtube.com/watch?v=brxx81U6N1o</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># There doesn't seem to be any difference with the weighted version, but I think I might be doing this wrong!</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>SSESwght<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_survey_rep</span>(<span class="at">variables=</span><span class="fu">c</span>(STA_CUR01), <span class="at">type =</span> <span class="st">"JK1"</span>, <span class="at">weights=</span>WT2019,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">repweights =</span> rwgt1<span class="sc">:</span>rwgt76, <span class="at">scale=</span>(<span class="dv">75</span><span class="sc">/</span><span class="dv">76</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">combined_weights =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>SSESwght<span class="ot">&lt;-</span>SSESwght<span class="sc">$</span>variables</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>SSESwght<span class="ot">&lt;-</span>SSESwght<span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">STA_CUR01Wght=</span>STA_CUR01)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>SumNoW<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID)<span class="sc">%&gt;%</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meancur=</span><span class="fu">mean</span>(STA_CUR01,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>SSESwght<span class="ot">&lt;-</span><span class="fu">cbind</span>(SSES, SSESwght)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>SumW<span class="ot">&lt;-</span>SSESwght<span class="sc">%&gt;%</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID)<span class="sc">%&gt;%</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meancur=</span><span class="fu">mean</span>(STA_CUR01Wght,<span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>SumNoW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   SiteID           meancur
   &lt;chr+lbl&gt;          &lt;dbl&gt;
 1 ""                NaN   
 2 "01" [Ottawa]       4.16
 3 "02" [Houston]      4.11
 4 "03" [Bogota]       4.18
 5 "04" [Manizales]    4.18
 6 "06" [Helsinki]     3.94
 7 "07" [Moscow]       3.99
 8 "08" [Istanbul]     4.18
 9 "09" [Daegu]        4.16
10 "10" [Sintra]       4.21
11 "11" [Suzhou]       4.14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>SumW</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
   SiteID           meancur
   &lt;chr+lbl&gt;          &lt;dbl&gt;
 1 ""                NaN   
 2 "01" [Ottawa]       4.16
 3 "02" [Houston]      4.11
 4 "03" [Bogota]       4.18
 5 "04" [Manizales]    4.18
 6 "06" [Helsinki]     3.94
 7 "07" [Moscow]       3.99
 8 "08" [Istanbul]     4.18
 9 "09" [Daegu]        4.16
10 "10" [Sintra]       4.21
11 "11" [Suzhou]       4.14</code></pre>
</div>
</div>
</section>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review">Literature review</h2>
<p>Curiosity, in the epistemic sense has been defined as individual’s search for intellectual stimulation <span class="citation" data-cites="vonstumm2011">Stumm, Hell, and Chamorro-Premuzic (<a href="#ref-vonstumm2011" role="doc-biblioref">2011</a>)</span>;</p>
<p>Loewenstein (<span class="citation" data-cites="loewenstein1994">(<a href="#ref-loewenstein1994" role="doc-biblioref"><strong>loewenstein1994?</strong></a>)</span>) argued that an individual becomes curious when they are made aware of an ‘information gap’ in their understanding.</p>
</section>
<section id="the-oecd-data-set" class="level2">
<h2 class="anchored" data-anchor-id="the-oecd-data-set">The OECD data set</h2>
<p>Since 2010, the OECD has been interested in carrying out research into young people’s social and emotional skills leading to the development of the Survey on Social and Emotional Skills (SSES) <span class="citation" data-cites="oecd2021">OECD (<a href="#ref-oecd2021" role="doc-biblioref">2021</a>)</span>. They survey was designed to report skills across five domains (open-mindedness, task performance, engaging with others, collaboration and emotional regulation) which mirrored the big five personality traits <span class="citation" data-cites="goldberg1993">Goldberg (<a href="#ref-goldberg1993" role="doc-biblioref">1993</a>)</span>. Within the domain of open-mindedness three skills were examined, curiosity, tolerance and creativity.</p>
<p>The survey was delivered online and completed by two cohorts of students aged 10 and 15-years old.</p>
<p>Students in cities shown in table x took part in the data collection</p>
<p>Table x: Participating cities</p>
<table class="table">
<thead>
<tr class="header">
<th>Participating Cities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bogotá, Colombia</td>
</tr>
<tr class="even">
<td>Daegu, South Korea</td>
</tr>
<tr class="odd">
<td>Helsinki, Finland</td>
</tr>
<tr class="even">
<td>Houston, Texas, United States</td>
</tr>
<tr class="odd">
<td>Istanbul, Turkey</td>
</tr>
<tr class="even">
<td>Manizales, Colombia</td>
</tr>
<tr class="odd">
<td>Moscow, Russian Federation</td>
</tr>
<tr class="even">
<td>Ottawa, Ontario, Canada</td>
</tr>
<tr class="odd">
<td>Sintra, Portugal</td>
</tr>
<tr class="even">
<td>Suzhou, People’s Republic of China</td>
</tr>
</tbody>
</table>
<p>The gender distribution of participating students is shown in table y.</p>
<p>Table y gender of participating students</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>demographics<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID, Gender_Std, CohortID)<span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_factor</span>()<span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Gender_Std, <span class="at">values_from =</span> n)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>demographics</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 21 × 5
# Groups:   SiteID [11]
   SiteID      CohortID          `NA` Female  Male
   &lt;fct&gt;       &lt;fct&gt;            &lt;int&gt;  &lt;int&gt; &lt;int&gt;
 1 ""          ""                  25     NA    NA
 2 "Ottawa"    "Younger cohort"   115   1576  1559
 3 "Ottawa"    "Older cohort"      36   1068  1086
 4 "Houston"   "Younger cohort"    34   1673  1626
 5 "Houston"   "Older cohort"      33   1613  1455
 6 "Bogota"    "Younger cohort"    21   1723  1671
 7 "Bogota"    "Older cohort"      27   1658  1671
 8 "Manizales" "Younger cohort"    26   1629  1571
 9 "Manizales" "Older cohort"      22   1824  1685
10 "Helsinki"  "Younger cohort"    30   1506  1498
# ℹ 11 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the variable we are interested in to numeric and character</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>SSES<span class="sc">$</span>st_anxtest<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(SSES<span class="sc">$</span>st_anxtest)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>SSES<span class="sc">$</span>STA_CUR01<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(SSES<span class="sc">$</span>STA_CUR01)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>SSES<span class="sc">$</span>Gender_Std<span class="ot">&lt;-</span><span class="fu">as.character</span>(SSES<span class="sc">$</span>Gender_Std)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean curiosity score by country</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Note I haven't used the weighted curiosity scores, I would need to do that properly in a more thorough analysis</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>CountCur<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteID, STA_CUR01)<span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SiteID)<span class="sc">%&gt;%</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanCur=</span><span class="fu">mean</span>(STA_CUR01, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>CountCur<span class="sc">$</span>SiteID<span class="ot">&lt;-</span><span class="fu">as_factor</span>(CountCur<span class="sc">$</span>SiteID)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CountCur, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(SiteID, <span class="sc">-</span>MeanCur), <span class="at">y=</span>MeanCur, <span class="at">fill=</span>SiteID))<span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()<span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"City"</span>)<span class="sc">+</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Mean curiosity score"</span>)<span class="sc">+</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`position_stack()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(SSES<span class="sc">$</span>STA_CUR01)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(SSES<span class="sc">$</span>STA_CUR01, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(SSES<span class="sc">$</span>STA_CUR06)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>SSES,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01)) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill=</span><span class="st">"darkseagreen4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 252 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>SSEStest<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SSES<span class="sc">$</span>STA_CUR01, SSES<span class="sc">$</span>STA_CUR02, SSES<span class="sc">$</span>STA_PER07, SSES<span class="sc">$</span>STA_PER08,SSES<span class="sc">$</span>st_anxtest, <span class="fu">as.numeric</span>(SSES<span class="sc">$</span>Gender_Std))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>cor<span class="ot">&lt;-</span><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(df), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(cor, <span class="at">order =</span> <span class="st">'AOE'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>cor<span class="ot">&lt;-</span><span class="fu">cor.test</span>(SSES<span class="sc">$</span>STA_CUR01, SSES<span class="sc">$</span>st_anxtest)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>cor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSES$STA_CUR01 and SSES$st_anxtest
t = 8.1218, df = 57529, p-value = 4.685e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.02567784 0.04200201
sample estimates:
       cor 
0.03384218 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a contingency table for the Wilcox Rank Test</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>conttab<span class="ot">&lt;-</span><span class="fu">xtabs</span>(<span class="sc">~</span> Gender_Std <span class="sc">+</span> STA_CUR01, <span class="at">data=</span>SSES)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the table to a data-frame as that is what wilcox.test wants! (and make the varibales numeric)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>conttab<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(conttab)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>conttab<span class="sc">$</span>Gender_Std<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(conttab<span class="sc">$</span>Gender_Std)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>conttab<span class="sc">$</span>STA_CUR01<span class="ot">&lt;-</span><span class="fu">as.numeric</span>(conttab<span class="sc">$</span>STA_CUR01)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># For fun plot the graphs - there looks to be very little difference by gender</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>conttab, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>Freq, <span class="at">fill=</span>Gender_Std))<span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">stat=</span><span class="st">'identity'</span>)<span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Gender_Std)<span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"null"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_col(stat = "identity"): Ignoring unknown parameters: `stat`</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the wilcox test - which returns p=1 so no difference!</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(STA_CUR01 <span class="sc">~</span> Gender_Std, <span class="at">data=</span>conttab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in wilcox.test.default(x = DATA[[1L]], y = DATA[[2L]], ...): cannot
compute exact p-value with ties</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  STA_CUR01 by Gender_Std
W = 12.5, p-value = 1
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SSES<span class="sc">$</span>STA_CUR01, SSES<span class="sc">$</span>STA_CUR02, SSES<span class="sc">$</span>STA_PER07, SSES<span class="sc">$</span>STA_PER08)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(df), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               SSES.STA_CUR01 SSES.STA_CUR02 SSES.STA_PER07 SSES.STA_PER08
SSES.STA_CUR01      1.0000000      0.2754213      0.1537268      0.1872675
SSES.STA_CUR02      0.2754213      1.0000000      0.2642251      0.3636892
SSES.STA_PER07      0.1537268      0.2642251      1.0000000      0.4006114
SSES.STA_PER08      0.1872675      0.3636892      0.4006114      1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#un-reversing the reversed item</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>rc <span class="ot">&lt;-</span> (<span class="dv">6</span> <span class="sc">-</span> SSES<span class="sc">$</span>STA_CUR06)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SSES<span class="sc">$</span>STA_CUR01, SSES<span class="sc">$</span>STA_CUR02, SSES<span class="sc">$</span>STA_CUR03, SSES<span class="sc">$</span>STA_CUR04, SSES<span class="sc">$</span>STA_CUR05, rc, SSES<span class="sc">$</span>STA_CUR07, SSES<span class="sc">$</span>STA_CUR08)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate Cronbach's Alpha</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cronbach.alpha</span>(df, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cronbach's alpha for the 'df' data-set

Items: 8
Sample units: 61010
alpha: 0.795</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I think I've created my first 'meaningful' graphic!</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>CanCurLang<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteID, LANG, STA_CUR01)<span class="sc">%&gt;%</span> <span class="co"># Select cur01, city and lang variables</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SiteID<span class="sc">==</span><span class="st">"01"</span>)<span class="sc">%&gt;%</span> <span class="co"># Filter for Ottawa</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="co"># To prevent the levels for other countries confusing the table (not sure what this means or if necessary)</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot results</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> CanCurLang) <span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(STA_CUR01, LANG), <span class="at">fill=</span>LANG))<span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Language"</span>)<span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"How curious..."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `unite_()` was deprecated in tidyr 1.2.0.
ℹ Please use `unite()` instead.
ℹ The deprecated feature was likely used in the ggmosaic package.
  Please report the issue at &lt;https://github.com/haleyjeppson/ggmosaic&gt;.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>USCurLang<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SiteID, LANG, STA_CUR01)<span class="sc">%&gt;%</span> <span class="co"># City, Lang, Curiosity</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SiteID<span class="sc">==</span><span class="st">"02"</span>)<span class="sc">%&gt;%</span> <span class="co"># Filter Houston</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">droplevels</span>() <span class="co"># To prevent the levels for other countries confusing the table</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> USCurLang) <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mosaic</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">product</span>(STA_CUR01, LANG), <span class="at">fill=</span>LANG))<span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Language"</span>)<span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"How curious..."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I added parts of the teacher and parent databases to the student one. OECD presented this as 'triangulation' (not all CUR items available from teacher questionnaire). Previous attempts to do this showed that teacher curiosity assessments were influenced by student attainment. Results below seem to show this too (teacher CUR05 correlated with reading scores, student and parent CUR05 correlate with one another).</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggmosaic)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the sav file (the SPSS file)</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co"># SSES&lt;-read_sav("/Users/cr/Downloads/INT_01_ST_(2021.04.14)_Public.sav")</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>SSES<span class="ot">&lt;-</span><span class="fu">read_sav</span>(<span class="st">"/Users/k1765032/Downloads/INT_01_ST_(2021.04.14)_Public.sav"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of troublesome SPSS format</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>SSES<span class="ot">&lt;-</span><span class="fu">zap_label</span>(SSES)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the variable we are interested in to numeric and character</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Parent database</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># SSESP&lt;-read_sav("/Users/cr/Downloads/INT_02_PA_(2021.04.14)_Public.sav")</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>SSESP<span class="ot">&lt;-</span><span class="fu">read_sav</span>(<span class="st">"/Users/k1765032/Downloads/INT_02_PA_(2021.04.14)_Public.sav"</span>)</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of troublesome SPSS format</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>SSESP<span class="ot">&lt;-</span><span class="fu">zap_label</span>(SSESP)</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the variable we are interested in to numeric and character</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Teacher database</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="co"># SSEST&lt;-read_sav("/Users/cr/Downloads/INT_03_TC_(2021.04.14)_Public.sav")</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>SSEST<span class="ot">&lt;-</span><span class="fu">read_sav</span>(<span class="st">"/Users/k1765032/Downloads/INT_03_TC_(2021.04.14)_Public.sav"</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of troublesome SPSS format</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>SSEST<span class="ot">&lt;-</span><span class="fu">zap_label</span>(SSEST)</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating database with some parental data</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>SSESParents <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>  SSES <span class="sc">%&gt;%</span> <span class="fu">select</span>(Username_Std, Sgrade_Read_Lang, CohortID, STA_CUR01, STA_CUR02, STA_CUR03, STA_CUR04, STA_CUR05, STA_CUR06, STA_CUR07, STA_TOL01, STA_TOL02),</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>  SSESP <span class="sc">%&gt;%</span> <span class="fu">select</span>(Username_Std, PAA_CUR01, PAA_CUR02, PAA_CUR03, PAA_CUR04, PAA_CUR05, PAA_CUR06, PAA_CUR07, PAA_CUR08),</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Username_Std"</span>))</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation test to check it works</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSESParents<span class="sc">$</span>STA_CUR01, SSESParents<span class="sc">$</span>PAA_CUR01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSESParents$STA_CUR01 and SSESParents$PAA_CUR01
t = 26.806, df = 34399, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1326796 0.1533818
sample estimates:
      cor 
0.1430463 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating database with some teacher data added</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>SSESParentsandTeachers <span class="ot">&lt;-</span> <span class="fu">left_join</span>(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  SSESParents <span class="sc">%&gt;%</span> <span class="fu">select</span>(Username_Std, Sgrade_Read_Lang, CohortID, STA_CUR01, STA_CUR02, STA_CUR03, STA_CUR04, STA_CUR05, STA_CUR06, STA_CUR07, STA_TOL01, STA_TOL02, PAA_CUR01, PAA_CUR02, PAA_CUR03, PAA_CUR04, PAA_CUR05, PAA_CUR06, PAA_CUR07, PAA_CUR08),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  SSEST <span class="sc">%&gt;%</span> <span class="fu">select</span>(Username_Std, TCA_CUR05, TCA_CUR06, TCA_CUR07),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">by=</span><span class="fu">c</span>(<span class="st">"Username_Std"</span>))</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Not sure whether all this is necessary but was getting error messages about something not being numeric </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># For me, this runs without the conversion! </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># SSESParentsandTeachers$Sgrade_Read_Lang&lt;-as.numeric(SSES$Sgrade_Read_Lang)</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$TCA_CUR05&lt;-as.numeric(SSES$TCA_CUR05)</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$TCA_CUR06&lt;-as.numeric(SSES$TCA_CUR06)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$TCA_CUR07&lt;-as.numeric(SSES$TCA_CUR07)</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR01&lt;-as.numeric(SSES$PAA_CUR01)</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR02&lt;-as.numeric(SSES$PAA_CUR02)</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR03&lt;-as.numeric(SSES$PAA_CUR03)</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR04&lt;-as.numeric(SSES$PAA_CUR04)</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR05&lt;-as.numeric(SSES$PAA_CUR05)</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR06&lt;-as.numeric(SSES$PAA_CUR06)</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR07&lt;-as.numeric(SSES$PAA_CUR07)</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="co">#SSESParentsandTeachers$PAA_CUR08&lt;-as.numeric(SSES$PAA_CUR08)</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation test to check it works</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSESParentsandTeachers<span class="sc">$</span>Sgrade_Read_Lang, SSESParentsandTeachers<span class="sc">$</span>PAA_CUR01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSESParentsandTeachers$Sgrade_Read_Lang and SSESParentsandTeachers$PAA_CUR01
t = 15.436, df = 31258, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.07596468 0.09796804
sample estimates:
       cor 
0.08697697 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Database comparing reading test scores to parental, teacher and self-assessed like learning new things</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>dfPT <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(SSESParentsandTeachers<span class="sc">$</span>Sgrade_Read_Lang, SSESParentsandTeachers<span class="sc">$</span>TCA_CUR05, SSESParentsandTeachers<span class="sc">$</span>STA_CUR05, SSESParentsandTeachers<span class="sc">$</span>PAA_CUR05)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>PTTab<span class="ot">&lt;-</span><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(dfPT), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Database comparing reading test scores to parental, teacher and self-assessed like learning new things</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>corPTCur<span class="ot">&lt;-</span><span class="fu">cor</span>(<span class="at">x =</span> <span class="fu">as.matrix</span>(dfPT), <span class="at">method =</span> <span class="st">"pearson"</span>, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(corPTCur) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Reading scores"</span>, <span class="st">"Teachers:CUR05"</span>, <span class="st">"Parents:CUR05"</span>, <span class="st">"Students:CUR05"</span>)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(corPTCur) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Reading scores"</span>, <span class="st">"Teachers:CUR05"</span>, <span class="st">"Parents:CUR05"</span>, <span class="st">"Students:CUR05"</span>)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Now with added coefficients!</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(corPTCur, <span class="at">order =</span> <span class="st">'AOE'</span>, <span class="at">addCoef.col =</span> <span class="st">'black'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I didn't know you could do that!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This section isn't running for me - there seems to be a missing CohortID variable in the SSESSParentsandTeachers data frame</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed?</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co">#What happens to students' curiosity (CUR01) and questioning (CUR03) between the ages of 10 and 15? How well do parent perceptions correlate?</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Combining the data</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>PSCurDiff<span class="ot">&lt;-</span>SSESParentsandTeachers <span class="sc">%&gt;%</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CohortID) <span class="sc">%&gt;%</span> </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CohortID, PAA_CUR01, PAA_CUR03, STA_CUR01, STA_CUR03) <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">CurSt =</span> <span class="fu">mean</span>(STA_CUR01, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">QuSt =</span> <span class="fu">mean</span>(STA_CUR03, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">CurPa =</span> <span class="fu">mean</span>(PAA_CUR01, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">QuPa =</span> <span class="fu">mean</span>(PAA_CUR03, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">arrange</span>(CohortID)</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>PSCurDiff<span class="ot">&lt;-</span>PSCurDiff<span class="sc">%&gt;%</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>CohortID, <span class="at">names_to =</span> <span class="st">"GroupPerception"</span>, <span class="at">values_to =</span> <span class="st">"Scores"</span>)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PSCurDiff)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>PSCurDiff <span class="ot">&lt;-</span> PSCurDiff[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), ]</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PSCurDiff)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>PSCurDiff<span class="sc">$</span>new <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PSCurDiff)</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co"># This data plotted...</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PSCurDiff, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(GroupPerception, new), <span class="at">y=</span>Scores, <span class="at">fill=</span>CohortID))<span class="sc">+</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Perceptions of Students' Curiosity in and out of School by Group"</span>)<span class="sc">+</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Perception of Students' Curiosity"</span>)<span class="sc">+</span></span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Rating Group"</span>)<span class="sc">+</span></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="fl">4.5</span>)) <span class="sc">+</span> </span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'Age 10'</span>, <span class="st">'Age 15'</span>)) <span class="sc">+</span></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Scores, <span class="dv">1</span>)), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This section isn't running for me - there seems to be a missing CohortID variable in the SSESSParentsandTeachers data frameSSESSParentsandTeachers data frame</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed?</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">#how much does the gap between CUR05 (like to learn new things) and CUR07 (love learning new things at school) grow for each site between ages 10 and 15?</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Slightly improved version...</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Table of Curiosity Drop by Group</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>PTSCurDiff<span class="ot">&lt;-</span>SSESParentsandTeachers <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CohortID) <span class="sc">%&gt;%</span> </span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CohortID, PAA_CUR05, PAA_CUR07, TCA_CUR05, TCA_CUR07, STA_CUR05, STA_CUR07) <span class="sc">%&gt;%</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">CuriosityStudent =</span> <span class="fu">mean</span>(STA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">InSchCurStudent =</span> <span class="fu">mean</span>(STA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">CuriosityParents =</span> <span class="fu">mean</span>(PAA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">InSchCurParents =</span> <span class="fu">mean</span>(PAA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">CuriosityTeachers =</span> <span class="fu">mean</span>(TCA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">InSchCurTeachers =</span> <span class="fu">mean</span>(TCA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(CohortID)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PTSCurDiff)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>PTSCurDiff<span class="ot">&lt;-</span>PTSCurDiff<span class="sc">%&gt;%</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>CohortID, <span class="at">names_to =</span> <span class="st">"GroupPerception"</span>, <span class="at">values_to =</span> <span class="st">"Scores"</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>PTSCurDiff <span class="ot">&lt;-</span> PTSCurDiff[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), ]</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>PTSCurDiff<span class="sc">$</span>new <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PTSCurDiff)</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="co">#This data plotted...</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PTSCurDiff, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(GroupPerception, new), <span class="at">y=</span>Scores, <span class="at">fill=</span>CohortID))<span class="sc">+</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Perceptions of Students' Curiosity in and out of School by Group"</span>)<span class="sc">+</span></span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Perception of Students' Curiosity"</span>)<span class="sc">+</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Rating Group"</span>)<span class="sc">+</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">3.5</span>, <span class="fl">4.5</span>)) <span class="sc">+</span> </span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">'Age 10'</span>, <span class="st">'Age 15'</span>)) <span class="sc">+</span></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Scores, <span class="dv">1</span>)), <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.9</span>), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-1" class="level3">
<h3 class="anchored" data-anchor-id="section-1"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This section isn't running for me - there seems to be a missing CohortID variable in the SSESSParentsandTeachers data frame</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Another graph, with the differences between 05 and 07 calculated for each group</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>PTSCurDiff2<span class="ot">&lt;-</span>SSESParentsandTeachers <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CohortID) <span class="sc">%&gt;%</span> </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(CohortID, PAA_CUR05, PAA_CUR07, TCA_CUR05, TCA_CUR07, STA_CUR05, STA_CUR07) <span class="sc">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">meanNS =</span> <span class="fu">mean</span>(STA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanS =</span> <span class="fu">mean</span>(STA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">SchDiffStu =</span> meanS<span class="sc">-</span>meanNS,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanNSPa =</span> <span class="fu">mean</span>(PAA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanSPa =</span> <span class="fu">mean</span>(PAA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">SchDiffPrt =</span> meanSPa<span class="sc">-</span>meanNSPa,</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanNSTe =</span> <span class="fu">mean</span>(TCA_CUR05, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">meanSTe =</span> <span class="fu">mean</span>(TCA_CUR07, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">SchDiffTch =</span> meanSTe<span class="sc">-</span>meanNSTe,</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">students =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(meanS)) <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(CohortID)</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="co"># I imagine all these steps could be combined...</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>PTSCurDiff2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(PTSCurDiff2)</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>PTSCurDiff2<span class="ot">&lt;-</span>PTSCurDiff2<span class="sc">%&gt;%</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>meanS, <span class="sc">-</span>meanNS, <span class="sc">-</span>meanSPa, <span class="sc">-</span>meanNSPa, <span class="sc">-</span>meanSTe, <span class="sc">-</span>meanNSTe, <span class="sc">-</span>students)</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>PTSCurDiff2<span class="ot">&lt;-</span>PTSCurDiff2 <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>CohortID, <span class="at">names_to =</span> <span class="st">"Group"</span>, <span class="at">values_to =</span> <span class="st">"MeanDiffSch"</span>)</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(PTSCurDiff2)</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph showing perceptions of the difference between students' CUR05 (like to learn) and students' 07 (love to learn in school) for students, parents' and teachers</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(PTSCurDiff2, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>MeanDiffSch, <span class="at">fill=</span>CohortID))<span class="sc">+</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Just for interest, to show how the changes in various measures alighn with students' self-reported curiosity</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>CurByNumbers01<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STA_CUR01)<span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanRead =</span> <span class="fu">mean</span>(Sgrade_Read_Lang, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMath =</span> <span class="fu">mean</span>(Sgrade_Math, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanArt =</span> <span class="fu">mean</span>(Sgrade_Arts, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanInformed =</span> <span class="fu">mean</span>(STQM02507, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanFixed =</span> <span class="fu">mean</span>(STQM04403, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAnx =</span> <span class="fu">mean</span>(STQM04201, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanComp =</span> <span class="fu">mean</span>(STQM03804, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanRdBk =</span> <span class="fu">mean</span>(STQM03603, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanBks =</span> <span class="fu">mean</span>(STQM01001, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMotherListens =</span> <span class="fu">mean</span>(STQM02802A, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanFatherUnderstands =</span> <span class="fu">mean</span>(STQM02904B, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSatisfaction =</span> <span class="fu">mean</span>(STQM01901, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanTol =</span> <span class="fu">mean</span>(STA_TOL08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanCre =</span> <span class="fu">mean</span>(STA_CRE02, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanOpt =</span> <span class="fu">mean</span>(STA_OPT02, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanPer =</span> <span class="fu">mean</span>(STA_PER08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAnger =</span> <span class="fu">mean</span>(STA_EMO08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSES =</span> <span class="fu">mean</span>(STISEI_ST, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total =</span> <span class="fu">n</span>())</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>CurByNumbers01V2 <span class="ot">&lt;-</span> CurByNumbers01[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>), ]</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanRead))<span class="sc">+</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanBks))<span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanInformed))<span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanSatisfaction))<span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanTol))<span class="sc">+</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanCre))<span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbers01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanOpt))<span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">fill=</span><span class="st">"skyblue"</span>)<span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grouping students by curiosity value, separating by age</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>CurByNumbersAge01<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(STA_CUR01, CohortID)<span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanRead =</span> <span class="fu">mean</span>(Sgrade_Read_Lang, <span class="at">na.rm=</span><span class="cn">TRUE</span>), </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMath =</span> <span class="fu">mean</span>(Sgrade_Math, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanArt =</span> <span class="fu">mean</span>(Sgrade_Arts, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanInformed =</span> <span class="fu">mean</span>(STQM02507, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanFixed =</span> <span class="fu">mean</span>(STQM04403, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAnx =</span> <span class="fu">mean</span>(STQM04201, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanComp =</span> <span class="fu">mean</span>(STQM03804, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanRdBk =</span> <span class="fu">mean</span>(STQM03603, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanBks =</span> <span class="fu">mean</span>(STQM01001, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanMotherListens =</span> <span class="fu">mean</span>(STQM02802A, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanFatherUnderstands =</span> <span class="fu">mean</span>(STQM02904B, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSatisfaction =</span> <span class="fu">mean</span>(STQM01901, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanTol =</span> <span class="fu">mean</span>(STA_TOL08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanCre =</span> <span class="fu">mean</span>(STA_CRE02, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanOpt =</span> <span class="fu">mean</span>(STA_OPT02, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanPer =</span> <span class="fu">mean</span>(STA_PER08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanAnger =</span> <span class="fu">mean</span>(STA_EMO08, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">MeanSES =</span> <span class="fu">mean</span>(STISEI_ST, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>            <span class="at">Total =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'STA_CUR01'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>CurByNumbersAge01V2 <span class="ot">&lt;-</span> CurByNumbersAge01[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>), ]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbersAge01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>Total))<span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> CohortID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbersAge01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanSatisfaction))<span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> CohortID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(CurByNumbersAge01V2, <span class="fu">aes</span>(<span class="at">x=</span>STA_CUR01, <span class="at">y=</span>MeanRead))<span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">'identity'</span>, <span class="at">position =</span> <span class="fu">position_dodge2</span>())<span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(. <span class="sc">~</span> CohortID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-12-10.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-2" class="level3">
<h3 class="anchored" data-anchor-id="section-2"></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I think SSES$STISEI_ST might be their socioeconomic indicator. I wanted to test the correlations between this, curiosity and reading scores. The linear model gives significant results but low R2 value.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSES<span class="sc">$</span>STISEI_ST, SSES<span class="sc">$</span>Sgrade_Read_Lang)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSES$STISEI_ST and SSES$Sgrade_Read_Lang
t = 22.653, df = 41184, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1013880 0.1204658
sample estimates:
      cor 
0.1109371 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSES<span class="sc">$</span>STISEI_ST, SSES<span class="sc">$</span>STA_CUR01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSES$STISEI_ST and SSES$STA_CUR01
t = 13.114, df = 49263, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.05017656 0.06777595
sample estimates:
       cor 
0.05898084 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(SSES<span class="sc">$</span>Sgrade_Read_Lang, SSES<span class="sc">$</span>STA_CUR01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  SSES$Sgrade_Read_Lang and SSES$STA_CUR01
t = 17.013, df = 49571, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.06743323 0.08493690
sample estimates:
       cor 
0.07619093 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(easystats)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code># Attaching packages: easystats 0.6.0 (red = needs update)
✔ bayestestR  0.13.1   ✔ correlation 0.8.4 
✖ datawizard  0.7.1    ✖ effectsize  0.8.3 
✖ insight     0.19.2   ✔ modelbased  0.8.6 
✖ performance 0.10.4   ✖ parameters  0.21.1
✔ report      0.5.7    ✔ see         0.8.0 

Restart the R-Session and update packages in red with `easystats::easystats_update()`.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>CurSES<span class="ot">&lt;-</span><span class="fu">lm</span>(SSES<span class="sc">$</span>Sgrade_Read_Lang <span class="sc">~</span> SSES<span class="sc">$</span>STA_CUR01 <span class="sc">+</span> SSES<span class="sc">$</span>STISEI_ST, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) :
 extra argument 'na.rm' will be disregarded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is the same thing, passing the dataframe to data, and avoiding the repeated $ gets rid of the warnings!</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>CurSES<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">data=</span>SSES, Sgrade_Read_Lang <span class="sc">~</span> STA_CUR01 <span class="sc">+</span> STISEI_ST, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: In lm.fit(x, y, offset = offset, singular.ok = singular.ok, ...) :
 extra argument 'na.rm' will be disregarded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This looks like a neater way of doing it</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(CurSES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sgrade_Read_Lang ~ STA_CUR01 + STISEI_ST, data = SSES, 
    na.rm = TRUE)

Residuals:
    Min      1Q  Median      3Q     Max 
-36.977  -6.352   1.164   7.249  19.144 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 28.72821    0.29667   96.84   &lt;2e-16 ***
STA_CUR01    0.73725    0.05658   13.03   &lt;2e-16 ***
STISEI_ST    0.69527    0.03184   21.84   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.16 on 41110 degrees of freedom
  (19897 observations deleted due to missingness)
Multiple R-squared:  0.01634,   Adjusted R-squared:  0.01629 
F-statistic: 341.4 on 2 and 41110 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(CurSES)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>We fitted a linear model (estimated using OLS) to predict Sgrade_Read_Lang with
STA_CUR01 and STISEI_ST (formula: Sgrade_Read_Lang ~ STA_CUR01 + STISEI_ST).
The model explains a statistically significant and very weak proportion of
variance (R2 = 0.02, F(2, 41110) = 341.42, p &lt; .001, adj. R2 = 0.02). The
model's intercept, corresponding to STA_CUR01 = 0 and STISEI_ST = 0, is at
28.73 (95% CI [28.15, 29.31], t(41110) = 96.84, p &lt; .001). Within this model:

  - The effect of STA CUR01 is statistically significant and positive (beta =
0.74, 95% CI [0.63, 0.85], t(41110) = 13.03, p &lt; .001; Std. beta = 0.06, 95% CI
[0.05, 0.07])
  - The effect of STISEI ST is statistically significant and positive (beta =
0.70, 95% CI [0.63, 0.76], t(41110) = 21.84, p &lt; .001; Std. beta = 0.11, 95% CI
[0.10, 0.12])

Standardized parameters were obtained by fitting the model on a standardized
version of the dataset. 95% Confidence Intervals (CIs) and p-values were
computed using a Wald t-distribution approximation.</code></pre>
</div>
</div>
</section>
<section id="potential-questions-to-explore" class="level3">
<h3 class="anchored" data-anchor-id="potential-questions-to-explore">Potential questions to explore</h3>
<p>• Does the language of the test matter? Is there a variation in response according to the language respondents have been given the test in (e.g.&nbsp;Houston seems to have been administered in English and Spanish; Ottawa in French and English)? Obviously there may be other differences between e.g.&nbsp;the French- and English-speaking cohorts in Ottawa, but I imagine it would be possible to control for these to a degree.</p>
<p>• Your finding that Finnish students aren’t very curious could be worth exploring further. They’re also the students who find science least interesting (according to CUR08). Is there a way to link cities/countries to their success in the last round of PISA? It would be interesting to try to explain those findings, especially where there are discrepancies…</p>
<ul>
<li>Sadly it looks like you can’t get city level data out of the main PISA data set.</li>
</ul>
<p>• Some of the Tolerance items correlate as well with the curiosity items as the curiosity items do with one another, esp TOL02 Ask questions about other cultures ; TOL05 Like hearing about other cultures and religions , which is potentially interesting, esp TOL05. I haven’t tested corplot yet, but it might be nice for showing this.</p>
<p>• An analysis of patterns of change of curiosity with age, comparing in school and out of school curiosity.</p>
</section>
</section>
<section id="structural-equation-modelling" class="level2">
<h2 class="anchored" data-anchor-id="structural-equation-modelling">Structural equation modelling</h2>
<p>I have just learned how to do structural equation modelling, which builds a model of some output variable, based on a number of independent variables, which might be useful.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we tell lavaan what we want to model, e.g.:</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">"STA_CUR01 ~ SiteID + Gender_Std + st_anxtest"</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">sem</span>(model, <span class="at">data=</span>SSES)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 1 iteration

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         4

                                                  Used       Total
  Number of observations                         57482       61010

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  STA_CUR01 ~                                         
    SiteID           -0.001    0.001   -0.501    0.616
    Gender_Std       -0.074    0.008   -9.925    0.000
    st_anxtest        0.002    0.000    6.613    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .STA_CUR01         0.792    0.005  169.532    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit, <span class="at">whatLabels =</span> <span class="st">"Estimate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I like the diagram it produces - I'm going to try using this</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Another thing one can do with <code>lavaan</code> is to propose some latent variables and investigate their explanatory effectiveness. We might propose a psychological latent variable (lv1) composed of (<code>st_wellbeing</code> and <code>st_anxtest</code>) and a social environment latent variable (lv2) composed of (<code>st_bully</code>, <code>st_friends</code>, <code>st_belong</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First we tell lavaan what we want to model, note =~ indicates latent variables</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">"lv1 =~st_wellbeing + st_anxtest</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="st">        lv2 =~ st_bully + st_friends + st_belong</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="st">        STA_CUR01 ~ lv1 + lv2"</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">sem</span>(model, <span class="at">data=</span>SSES)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 135 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

                                                  Used       Total
  Number of observations                         56955       61010

Model Test User Model:
                                                      
  Test statistic                              2247.287
  Degrees of freedom                                 7
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lv1 =~                                              
    st_wellbeing      1.000                           
    st_anxtest       -0.371    0.009  -43.506    0.000
  lv2 =~                                              
    st_bully          1.000                           
    st_friends       -1.977    0.033  -60.394    0.000
    st_belong        -2.831    0.047  -60.336    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  STA_CUR01 ~                                         
    lv1               0.009    0.001    8.165    0.000
    lv2              -0.021    0.003   -7.939    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lv1 ~~                                              
    lv2             -28.570    0.522  -54.757    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .st_wellbeing     82.202    2.223   36.983    0.000
   .st_anxtest      162.545    1.008  161.219    0.000
   .st_bully        139.913    0.858  163.038    0.000
   .st_friends      112.587    0.850  132.439    0.000
   .st_belong        52.712    1.087   48.507    0.000
   .STA_CUR01         0.766    0.005  166.817    0.000
    lv1              99.204    2.371   41.841    0.000
    lv2              14.524    0.446   32.545    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit, <span class="at">whatLabels =</span> <span class="st">"Estimate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Neither of the proposed latent variables seem to have much influence!</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># An alternative is to the use the items to construct latent variables for e.g. cooperation, empathy, emotional control</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">"lv1 =~STA_COO01 + STA_COO02 + STA_COO03+ STA_COO04 + STA_COO05   </span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="st">              +STA_COO06 + STA_COO07</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="st">        lv2 =~ STA_EMP01 + STA_EMP02 + STA_EMP03+ STA_EMP04 + STA_EMP05   </span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="st">              +STA_EMP06 + STA_EMP07</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="st">        lv3 =~ STA_EMO01 + STA_EMO02 + STA_EMO03+ STA_EMO04 + STA_EMO05   </span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="st">              +STA_EMO06 + STA_EMO07</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="st">        STA_CUR01 ~ lv1 + lv2 +lv3"</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">sem</span>(model, <span class="at">data=</span>SSES)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.16 ended normally after 54 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        49

                                                  Used       Total
  Number of observations                         58236       61010

Model Test User Model:
                                                       
  Test statistic                              57854.957
  Degrees of freedom                                204
  P-value (Chi-square)                            0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lv1 =~                                              
    STA_COO01         1.000                           
    STA_COO02         0.974    0.008  124.516    0.000
    STA_COO03         0.998    0.008  122.842    0.000
    STA_COO04        -0.604    0.009  -67.529    0.000
    STA_COO05         0.895    0.007  122.874    0.000
    STA_COO06         1.161    0.009  136.313    0.000
    STA_COO07         1.214    0.009  138.124    0.000
  lv2 =~                                              
    STA_EMP01         1.000                           
    STA_EMP02         0.741    0.008   87.481    0.000
    STA_EMP03         1.030    0.010   98.555    0.000
    STA_EMP04         1.163    0.011  105.321    0.000
    STA_EMP05         0.938    0.011   87.553    0.000
    STA_EMP06         1.129    0.011  106.165    0.000
    STA_EMP07         1.043    0.011   98.649    0.000
  lv3 =~                                              
    STA_EMO01         1.000                           
    STA_EMO02         1.141    0.012   94.318    0.000
    STA_EMO03        -1.537    0.016  -96.644    0.000
    STA_EMO04         1.378    0.014   97.529    0.000
    STA_EMO05        -1.198    0.014  -85.592    0.000
    STA_EMO06        -0.974    0.013  -76.157    0.000
    STA_EMO07         0.960    0.012   80.212    0.000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  STA_CUR01 ~                                         
    lv1               0.216    0.023    9.283    0.000
    lv2               0.468    0.024   19.174    0.000
    lv3              -0.120    0.009  -13.344    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  lv1 ~~                                              
    lv2               0.231    0.003   91.113    0.000
    lv3               0.130    0.002   64.195    0.000
  lv2 ~~                                              
    lv3               0.097    0.002   53.036    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .STA_COO01         0.411    0.003  150.258    0.000
   .STA_COO02         0.449    0.003  153.010    0.000
   .STA_COO03         0.498    0.003  153.919    0.000
   .STA_COO04         0.982    0.006  167.558    0.000
   .STA_COO05         0.400    0.003  153.902    0.000
   .STA_COO06         0.430    0.003  144.313    0.000
   .STA_COO07         0.440    0.003  142.470    0.000
   .STA_EMP01         0.538    0.004  152.440    0.000
   .STA_EMP02         0.534    0.003  160.668    0.000
   .STA_EMP03         0.679    0.004  155.390    0.000
   .STA_EMP04         0.656    0.004  150.407    0.000
   .STA_EMP05         0.853    0.005  160.641    0.000
   .STA_EMP06         0.596    0.004  149.638    0.000
   .STA_EMP07         0.693    0.004  155.332    0.000
   .STA_EMO01         0.928    0.006  155.821    0.000
   .STA_EMO02         0.593    0.004  140.150    0.000
   .STA_EMO03         0.896    0.007  134.005    0.000
   .STA_EMO04         0.667    0.005  131.047    0.000
   .STA_EMO05         1.120    0.007  152.995    0.000
   .STA_EMO06         1.193    0.007  159.725    0.000
   .STA_EMO07         0.951    0.006  157.329    0.000
   .STA_CUR01         0.696    0.004  165.012    0.000
    lv1               0.287    0.004   80.782    0.000
    lv2               0.251    0.004   67.170    0.000
    lv3               0.288    0.005   55.349    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(fit, <span class="at">whatLabels =</span> <span class="st">"Estimate"</span>, <span class="at">rotation=</span><span class="dv">2</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.8</span>, <span class="at">sizeMan =</span><span class="dv">3</span>, <span class="st">"std"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interesting that the empathy latent variable has the highest loading here, and that the loading of the emotion latent variable is negative!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="bayesian-multiple-model-fitting" class="level3">
<h3 class="anchored" data-anchor-id="bayesian-multiple-model-fitting">Bayesian Multiple Model Fitting</h3>
<p>This approach is not recommended:</p>
<blockquote class="blockquote">
<p>“Let the computer find out” is a poor strategy and usually reflects the fact that the researcher did not bother to think clearly about the problem of interest and its scientific setting” - <span class="citation" data-cites="anderson2004model">(<a href="#ref-anderson2004model" role="doc-biblioref">Anderson and Burnham 2004, 147</a>)</span></p>
</blockquote>
<p>But the <code>BayesFactor</code> package allows you to generate multiple models, based on different combinations of variables in a data set and compare their predictive power.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset of the data frame, including variables we want to include in model building (+ need to remove NAs) </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>SESSsubset<span class="ot">&lt;-</span>SSES<span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(STA_CUR01, SiteID, Gender_Std, STA_ASS01,STA_EMO01,</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>         STA_ENE01,STA_OPT01)<span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># call regressionBD to create different models for the STA_CUR01 variable using all the other variables in the data frame </span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>models<span class="ot">&lt;-</span><span class="fu">regressionBF</span>(STA_CUR01 <span class="sc">~</span> ., <span class="at">data =</span> SESSsubset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments
Error in nWayFormula(formula = formula, data = data, dataTypes = dataTypes,  : 
  formal argument "dataTypes" matched by multiple actual arguments</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select only the relevant part of the output</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>output<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(models<span class="sc">@</span>bayesFactor)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Arrange the output</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>output<span class="ot">&lt;-</span>output<span class="sc">%&gt;%</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(output<span class="sc">$</span>bf))</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                                 bf
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01 1943.687
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01             1920.492
Gender_Std + STA_ASS01 + STA_ENE01 + STA_OPT01             1892.657
Gender_Std + STA_ASS01 + STA_ENE01                         1881.470
STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01              1831.107
STA_ASS01 + STA_EMO01 + STA_ENE01                          1796.292
                                                                  error
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01 1.193456e-04
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01             2.369470e-07
Gender_Std + STA_ASS01 + STA_ENE01 + STA_OPT01             4.057525e-07
Gender_Std + STA_ASS01 + STA_ENE01                         1.154868e-05
STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01              6.819002e-05
STA_ASS01 + STA_EMO01 + STA_ENE01                          1.423306e-05
                                                                               time
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01 Wed Nov  1 08:18:36 2023
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01             Wed Nov  1 08:18:36 2023
Gender_Std + STA_ASS01 + STA_ENE01 + STA_OPT01             Wed Nov  1 08:18:36 2023
Gender_Std + STA_ASS01 + STA_ENE01                         Wed Nov  1 08:18:36 2023
STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01              Wed Nov  1 08:18:36 2023
STA_ASS01 + STA_EMO01 + STA_ENE01                          Wed Nov  1 08:18:36 2023
                                                                   code
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01 e0135525e10c
Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01             e01323a10842
Gender_Std + STA_ASS01 + STA_ENE01 + STA_OPT01             e01312537ccc
Gender_Std + STA_ASS01 + STA_ENE01                         e0137f4cfd1f
STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01              e0133fcfcfaa
STA_ASS01 + STA_EMO01 + STA_ENE01                          e01320cb0b31</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The column we are interested in is bf, the Bayes Factor, which is a ratio of the likelihood of different models to a intercept only model (i.e. a horizontal line). So the best model with the variables I input is: STA_CUR01 ~ Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01, which has a bf of 1943 so us 1943 times better than an intercept only model</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>output<span class="ot">&lt;-</span>output<span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>()<span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(bf<span class="sc">&gt;</span><span class="dv">100</span>) <span class="co"># Get rid of NAs and there are lots of combinations of models so only plot the best!</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(output, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(<span class="fu">rownames</span>(output), <span class="sc">-</span> bf), <span class="at">y=</span>bf, <span class="at">fill=</span><span class="fu">rownames</span>(output)))<span class="sc">+</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust=</span><span class="dv">1</span>, <span class="at">size=</span><span class="dv">5</span>))<span class="sc">+</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="OECDCuriosity2_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It is interesting to note how explanatory powerful even quite simple models are: STA_ASS01 + STA_ENE01 does surprisingly well! It explains 91% of the more complex Gender_Std + STA_ASS01 + STA_EMO01 + STA_ENE01 + STA_OPT01</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co"># I get an error message when I try to load the BayesFactor package for some reason. I'll keep trying with it... Interesting finding about the fit with assertiveness and energy though!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-anderson2004model" class="csl-entry" role="listitem">
Anderson, D, and K Burnham. 2004. <span>“Model Selection and Multi-Model Inference.”</span> <em>Second. NY: Springer-Verlag</em> 63 (2020): 10.
</div>
<div id="ref-goldberg1993" class="csl-entry" role="listitem">
Goldberg, Lewis R. 1993. <span>“The Structure of Phenotypic Personality Traits.”</span> <em>American Psychologist</em> 48 (1): 26–34. <a href="https://doi.org/10.1037/0003-066X.48.1.26">https://doi.org/10.1037/0003-066X.48.1.26</a>.
</div>
<div id="ref-oecd2021" class="csl-entry" role="listitem">
OECD. 2021. <span>“Beyond Academic Learning: First Results from the Survey of Social and Emotional Skills 2019.”</span> <a href="https://doi.org/10.1787/92a11084-en">https://doi.org/10.1787/92a11084-en</a>.
</div>
<div id="ref-vonstumm2011" class="csl-entry" role="listitem">
Stumm, Sophie von, Benedikt Hell, and Tomas Chamorro-Premuzic. 2011. <span>“The Hungry Mind: Intellectual Curiosity Is the Third Pillar of Academic Performance.”</span> <em>Perspectives on Psychological Science</em> 6 (6): 574–88. <a href="https://doi.org/10.1177/1745691611421204">https://doi.org/10.1177/1745691611421204</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>